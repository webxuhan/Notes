<!DOCTYPE html>
<!-- saved from url=(0049)http://cnodejs.org/topic/504b4924e2b84515770103dd -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- meta -->
  
  <meta name="description" content="CNode：Node.js专业中文社区">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="nodejs, node, express, connect, socket.io">
  <!-- see http://smerity.com/articles/2013/where_did_all_the_http_referrers_go.html -->
  <meta name="referrer" content="always">

  
  <meta name="author" content="EDP@TaoBao">
  
  <meta property="wb:webmaster" content="617be6bd946c6b96">
  

  <link title="RSS" type="application/rss+xml" rel="alternate" href="http://cnodejs.org/rss">

  
  <link rel="icon" href="http://o4j806krb.qnssl.com/public/images/cnode_icon_32.png" type="image/x-icon">
  

  <!-- style -->
  <link rel="stylesheet" href="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/index.min.9d1ebdbb.min.css" media="all">


  <!-- scripts -->
  <script async="" src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/analytics.js.下载"></script><script src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/index.min.aeb155e1.min.js.下载"></script>


  
  <title>Mongoose学习参考文档——基础篇 - CNode技术社区</title>
  
  <meta content="_csrf" name="csrf-param">
  <meta content="NO8vE0iK-fhv4WoHOFwOMR861labRmabowd8" name="csrf-token">
</head>
<body>
<!-- navbar -->
<div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="http://cnodejs.org/">
        
          <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/cnodejs_light.svg">
        
      </a>

      <form id="search_form" class="navbar-search" action="http://cnodejs.org/search">
        <input type="text" id="q" name="q" class="search-query span3" value="">
      </form>
      <ul class="nav pull-right">
        <li><a href="http://cnodejs.org/">首页</a></li>
        
        <li><a href="http://cnodejs.org/getstart">新手入门</a></li>
        <li><a href="http://cnodejs.org/api">API</a></li>
        
        <li><a href="http://cnodejs.org/about" target="">关于</a></li>
        
        
        <li><a href="http://cnodejs.org/signup">注册</a></li>
        <li><a href="http://cnodejs.org/signin">登录</a></li>
        
      </ul>
      <a class="btn btn-navbar" id="responsive-sidebar-trigger">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
    </div>
  </div>
</div>
<div id="main">
  <div id="sidebar">
  <div class="panel">
    <div class="header">
      <span class="col_fade">作者</span>
    </div>
    <div class="inner">
      <div class="user_card">
  <div>
    <a class="user_avatar" href="http://cnodejs.org/user/a272121742">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742">
    </a>
    <span class="user_name"><a class="dark" href="http://cnodejs.org/user/a272121742">a272121742</a></span>

    <div class="board clearfix">
      <div class="floor">
        <span class="big">积分: 2295 </span>
      </div>
    </div>
    <div class="space clearfix"></div>
    <span class="signature">
        “
        
            这家伙很懒，什么个性签名都没有留下。
        
        ”
    </span>
  </div>
</div>



    </div>
  </div>

  
    
<div class="panel">
  <div class="inner ads">

    
      
      <a href="https://alinode.aliyun.com/?ref=cnode" target="_blank" class="banner sponsor_outlink" data-label="alinode">
        <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/Fn4D6BhOTz1IswvmzeZ1q7QW1ls_">
      </a>
    
      
        <div class="sep10"></div>
      
      <a href="http://www.ucloud.cn/site/active/gift.html?utm_source=cnodejs&amp;utm_medium=content_pic_pc&amp;utm_campaign=multicloud&amp;utm_content=gift&amp;ytag=cnodejs" target="_blank" class="banner sponsor_outlink" data-label="ucloud-banner">
        <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/FgQS-GQDfqwAD_v0NuhyYUOUk5MG">
      </a>
    
      
        <div class="sep10"></div>
      
      <a href="https://0x6.me/CnodeAD" target="_blank" class="banner sponsor_outlink" data-label="huoqiu">
        <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/Fh-dDBC360-fT8gaefK0p_hmx_zv">
      </a>
    
  </div>
</div>

  

  <div class="panel">
    <div class="header">
      <span class="col_fade">作者其它话题</span>
    </div>
    <div class="inner">
      
      <ul class="unstyled">
        <li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/508834ee65e98a980983b3d2" title="[问题]Mongoose如何实现统计查询、关联查询">[问题]Mongoose如何实现统计查询、关联查询</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/5082ceac65e98a98093220e6" title="[问题]HttpServer中的Response的writeHead和setHeader方法有什么本质区别">[问题]HttpServer中的Response的writeHead和setHeader方法有什么本质区别</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/539aa72ac3ee0b5820a1d200" title="【求关注】关注Meteor或使用Meteor的来看！">【求关注】关注Meteor或使用Meteor的来看！</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/52131a200a746c580b4cba7e" title="[问题]Meteor多APP合并">[问题]Meteor多APP合并</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/516788246d382773060114e0" title="【分享】我在rrestjs架构基础上扩展的内容">【分享】我在rrestjs架构基础上扩展的内容</a>
  </div>
</li>

      </ul>
      
    </div>
  </div>

  <div class="panel">
    <div class="header">
      <span class="col_fade">无人回复的话题</span>
    </div>
    <div class="inner">
      
      <ul class="unstyled">
        <li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/590df016cfb837012a59b44f" title="electron 安装报错">electron 安装报错</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/590d9bcd3504ce1c2ac4591d" title="基于vue-cli、Vue2.0 构建的单页面应用---&gt;vue.js 中文社区">基于vue-cli、Vue2.0 构建的单页面应用---&gt;vue.js 中文社区</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/590d48ba3504ce1c2ac45908" title="node中挂载了全局变量，载JavaScript重怎么使用，没使用ajax">node中挂载了全局变量，载JavaScript重怎么使用，没使用ajax</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/590c35f6ba8670562a40ed3b" title="使用webpack的require.context实现路由“去中心化”管理">使用webpack的require.context实现路由“去中心化”管理</a>
  </div>
</li>
<li>
  <div><a class="dark topic_title" href="http://cnodejs.org/topic/590bf4fe11bdaf96035d8bc4" title="tcp连接中一秒内接收多个数据会有重复并丢失">tcp连接中一秒内接收多个数据会有重复并丢失</a>
  </div>
</li>

      </ul>
      
    </div>
  </div>
</div>

<div id="content">
  <div class="panel">
    <div class="header topic_header">
      <span class="topic_full_title">

        
<span class="put_good">精华</span>



        Mongoose学习参考文档——基础篇
      </span>
      <div class="changes">
        <span>
          发布于 5 年前
        </span>
        <span>
          作者 <a href="http://cnodejs.org/user/a272121742">a272121742</a>
        </span>
        <span>
          174975 次浏览
        </span>
        
          <span>
            最后一次编辑是 8 个月前
          </span>
        
        

        

      </div>
      
    </div>
    <div class="inner topic">

      <div class="topic_content">
        <div class="markdown-text"><h2>Mongoose学习参考文档</h2>
<p><strong>前言</strong>：本学习参考文档仅供参考，如有问题，师请雅正</p>
<p>##一、快速通道</p>
<p>###1.1 名词解释</p>
<ul>
<li>
<p><code>Schema</code>  ：  一种以文件形式存储的数据库模型骨架，不具备数据库的操作能力</p>
</li>
<li>
<p><code>Model</code>   ：  由<code>Schema</code>发布生成的模型，具有抽象属性和行为的数据库操作对</p>
</li>
<li>
<p><code>Entity</code>  ：  由<code>Model</code>创建的实体，他的操作也会影响数据库</p>
</li>
</ul>
<p><strong>注意</strong>：</p>
<p>1.本学习文档采用严格命名方式来区别不同对象，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pun">;</span><span class="pln">   </span><span class="com">//Person的文本属性</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">;</span><span class="pln">    </span><span class="com">//Person的数据库模型</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonEntity</span><span class="pun">;</span><span class="pln">   </span><span class="com">//Person实体</span></code></pre><p>2.<code>Schema</code>、<code>Model</code>、<code>Entity</code>的关系请牢记，<code>Schema</code>生成<code>Model</code>，<code>Model</code>创造<code>Entity</code>，<code>Model</code>和<code>Entity</code>都可对数据库操作造成影响，但<code>Model</code>比<code>Entity</code>更具操作性。</p>
<p>##1.2 准备工作</p>
<p>1.首先你必须安装<a href="http://www.mongodb.org/" target="_blank">MongoDB</a>和<a href="http://nodejs.org/" target="_blank">NodeJS</a></p>
<p>2.在项目只能够创建一个数据库连接，如下:</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> mongoose </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'mongoose'</span><span class="pun">);</span><span class="pln">    </span><span class="com">//引用mongoose模块</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">createConnection</span><span class="pun">(</span><span class="str">'localhost'</span><span class="pun">,</span><span class="str">'test'</span><span class="pun">);</span><span class="pln"> </span><span class="com">//创建一个数据库连接</span></code></pre><p>3.打开本机<code>localhost</code>的<code>test</code>数据库时，我们可以监测是否有异常</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    db</span><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">'error'</span><span class="pun">,</span><span class="pln">console</span><span class="pun">.</span><span class="pln">error</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">console</span><span class="pun">,</span><span class="str">'连接错误:'</span><span class="pun">));</span><span class="pln">
    db</span><span class="pun">.</span><span class="pln">once</span><span class="pun">(</span><span class="str">'open'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
      </span><span class="com">//一次打开记录</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p><strong>注意</strong>：</p>
<p>成功开启数据库后，就可以执行数据库相应操作，假设以下代码都在回调中处理</p>
<p>4.定义一个<code>Schema</code></p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:</span><span class="typ">String</span><span class="pln">   </span><span class="com">//定义一个属性name，类型为String</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>5.将该<code>Schema</code>发布为<code>Model</code></p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//如果该Model已经发布，则可以直接通过名字索引到，如下：</span><span class="pln">
    </span><span class="com">//var PersonModel = db.model('Person');</span><span class="pln">
    </span><span class="com">//如果没有发布，上一段代码将会异常</span></code></pre><p>6.用<code>Model</code>创建<code>Entity</code></p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> personEntity </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'Krouky'</span><span class="pun">});</span><span class="pln">
    </span><span class="com">//打印这个实体的名字看看</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">personEntity</span><span class="pun">.</span><span class="pln">name</span><span class="pun">);</span><span class="pln"> </span><span class="com">//Krouky</span></code></pre><p>7.我们甚至可以为此<code>Schema</code>创建方法</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="com">//为Schema模型追加speak方法</span><span class="pln">
    </span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="pln">methos</span><span class="pun">.</span><span class="pln">speak </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'我的名字叫'</span><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> personEntity </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'Krouky'</span><span class="pun">});</span><span class="pln">
    personEntity</span><span class="pun">.</span><span class="pln">speak</span><span class="pun">();</span><span class="com">//我的名字叫Krouky</span></code></pre><p>8.<code>Entity</code>是具有具体的数据库操作<code>CRUD</code>的</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    personEntity</span><span class="pun">.</span><span class="pln">save</span><span class="pun">();</span><span class="pln">  </span><span class="com">//执行完成后，数据库就有该数据了</span></code></pre><p>9.如果要执行查询，需要依赖<code>Model</code>，当然<code>Entity</code>也是可以做到的</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">persons</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//查询到的所有person</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p><strong>注意</strong>：</p>
<p>1. 具体的如何配置<code>Schema</code>、<code>Model</code>以及<code>Model</code>和<code>Entity</code>的相关操作，我们会在后面进行</p>
<p>2. <code>Model</code>和<code>Entity</code>都有能影响数据库的操作，但仍有区别，后面我们也会做解释</p>
<p>##二、新手指引</p>
<p><em>如果您还不清楚<code>Mongoose</code>是如何工作的，请参看第一章快速通道快速浏览他的用法吧</em></p>
<p>###1. Schema——纯洁的数据库原型</p>
<p>####1.1 什么是Schema</p>
<ul>
<li>我理解<code>Schema</code>仅仅只是一断代码，他书写完成后程序依然无法使用，更无法通往数据库端</li>
<li>他仅仅只是数据库模型在程序片段中的一种表现，或者是数据属性模型</li>
</ul>
<p>####1.2 如何定义Schema</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">BlogSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      title</span><span class="pun">:</span><span class="typ">String</span><span class="pun">,</span><span class="pln">
      author</span><span class="pun">:</span><span class="typ">String</span><span class="pln">
      </span><span class="com">//new Schema()中传入一个JSON对象，该对象形如 xxx:yyyy ,</span><span class="pln">
      </span><span class="pun">/</span><span class="pln">xxx</span><span class="pun">是一个字符串，定义了属性，</span><span class="pln">yyy</span><span class="pun">是一个</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Type</span><span class="pun">，定义了属性类型</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####1.3 什么是Schema.Type</p>
<p><code>Schema.Type</code>是由<code>Mongoose</code>内定的一些数据类型，基本数据类型都在其中，他也内置了一些<code>Mongoose</code>特有的<code>Schema.Type</code>。当然，你也可以自定义<code>Schema.Type</code>，只有满足<code>Schema.Type</code>的类型才能定义在<code>Schema</code>内。</p>
<p>####1.4 Schema.Types</p>
<p><code>NodeJS</code>中的基本数据类型都属于<code>Schema.Type</code>，另外<code>Mongoose</code>还定义了自己的类型</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="com">//举例：</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:</span><span class="typ">String</span><span class="pun">,</span><span class="pln">
      binary</span><span class="pun">:</span><span class="typ">Buffer</span><span class="pun">,</span><span class="pln">
      living</span><span class="pun">:</span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln">
      updated</span><span class="pun">:</span><span class="typ">Date</span><span class="pun">,</span><span class="pln">
      age</span><span class="pun">:</span><span class="typ">Number</span><span class="pun">,</span><span class="pln">
      mixed</span><span class="pun">:</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">Mixed</span><span class="pun">,</span><span class="pln"> </span><span class="com">//该混合类型等同于nested</span><span class="pln">
      _id</span><span class="pun">:</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">ObjectId</span><span class="pun">,</span><span class="pln">  </span><span class="com">//主键</span><span class="pln">
      _fk</span><span class="pun">:</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">ObjectId</span><span class="pun">,</span><span class="pln">  </span><span class="com">//外键</span><span class="pln">
      array</span><span class="pun">:[],</span><span class="pln">
      arrOfString</span><span class="pun">:[</span><span class="typ">String</span><span class="pun">],</span><span class="pln">
      arrOfNumber</span><span class="pun">:[</span><span class="typ">Number</span><span class="pun">],</span><span class="pln">
      arrOfDate</span><span class="pun">:[</span><span class="typ">Date</span><span class="pun">],</span><span class="pln">
      arrOfBuffer</span><span class="pun">:[</span><span class="typ">Buffer</span><span class="pun">],</span><span class="pln">
      arrOfBoolean</span><span class="pun">:[</span><span class="typ">Boolean</span><span class="pun">],</span><span class="pln">
      arrOfMixed</span><span class="pun">:[</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">Mixed</span><span class="pun">],</span><span class="pln">
      arrOfObjectId</span><span class="pun">:[</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">ObjectId</span><span class="pun">]</span><span class="pln">
      nested</span><span class="pun">:{</span><span class="pln">
        stuff</span><span class="pun">:</span><span class="typ">String</span><span class="pun">,</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####1.5 关于Buffer</p>
<p><code>Buffer</code>和<code>ArrayBuffer</code>是<code>Nodejs</code>两种隐藏的对象，相关内容请查看<code>NodeJS-API</code></p>
<p>####1.6 关于Mixed</p>
<p><code>Schema.Types.Mixed</code>是<code>Mongoose</code>定义个混合类型，该混合类型如果未定义具体形式。因此,如果定义具体内容，就直接使用<code>{}</code>来定义，以下两句等价</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">AnySchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">any</span><span class="pun">:{}});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">AnySchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">any</span><span class="pun">:</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">Mixed</span><span class="pun">});</span></code></pre><p>混合类型因为没有特定约束，因此可以任意修改，一旦修改了原型，则必须调用<code>markModified()</code></p>
<pre class="prettyprint language-javascript"><code><span class="pln">    person</span><span class="pun">.</span><span class="pln">anything </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">x</span><span class="pun">:[</span><span class="lit">3</span><span class="pun">,</span><span class="lit">4</span><span class="pun">,{</span><span class="pln">y</span><span class="pun">:</span><span class="str">'change'</span><span class="pun">}]}</span><span class="pln">
    person</span><span class="pun">.</span><span class="pln">markModified</span><span class="pun">(</span><span class="str">'anything'</span><span class="pun">);</span><span class="com">//传入anything，表示该属性类型发生变化</span><span class="pln">
    person</span><span class="pun">.</span><span class="pln">save</span><span class="pun">();</span></code></pre><p>####1.7 关于ObjectId</p>
<p>主键，一种特殊而且非常重要的类型，每个<code>Schema</code>都会默认配置这个属性，属性名为<code>_id</code>，除非自己定义，方可覆盖</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> mongoose </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'mongoose'</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ObjectId</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">ObjectId</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">StudentSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({});</span><span class="pln"> </span><span class="com">//默认会有_id:ObjectId</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">TeacherSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">id</span><span class="pun">:</span><span class="typ">ObjectId</span><span class="pun">});</span><span class="com">//只有id:ObjectId</span></code></pre><p>该类型的值由系统自己生成，从某种意义上几乎不会重复，生成过程比较复杂，有兴趣的朋友可以查看源码。</p>
<p>####1.8 关于Array</p>
<p><code>Array</code>在<code>JavaScript</code>编程语言中并不是数组，而是集合，因此里面可以存入不同的值，以下代码等价：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">array</span><span class="pun">:[]});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">array</span><span class="pun">:</span><span class="typ">Array</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">array</span><span class="pun">:[</span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">Mixed</span><span class="pun">]});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">array</span><span class="pun">:[{}]});</span></code></pre><p>####1.9 附言</p>
<p><code>Schema</code>不仅定义了<code>文档结构</code>和<code>使用性能</code>，还可以有<code>扩展插件</code>、<code>实例方法</code>、<code>静态方法</code>、<code>复合索引</code>、<code>文档生命周期钩子</code></p>
<p><code>Schema</code>可以定义插件，并且插件具有良好的可拔插性，请有兴趣的读者继续往后阅读或者查阅官方资料。</p>
<p>###2. Schema的扩展</p>
<p>####2.1 实例方法</p>
<p>有的时候，我们创造的<code>Schema</code>不仅要为后面的<code>Model</code>和<code>Entity</code>提供公共的属性，还要提供公共的方法。</p>
<p>下面例子比快速通道的例子更加高级，可以进行高级扩展：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="typ">String</span><span class="pun">,</span><span class="pln">type</span><span class="pun">:</span><span class="typ">String</span><span class="pun">});</span><span class="pln">
    </span><span class="com">//查询类似数据</span><span class="pln">
    </span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="pln">methods</span><span class="pun">.</span><span class="pln">findSimilarTypes </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">cb</span><span class="pun">){</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">).</span><span class="pln">find</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">type</span><span class="pun">},</span><span class="pln">cb</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span></code></pre><p>使用如下：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'krouky'</span><span class="pun">,</span><span class="pln">type</span><span class="pun">:</span><span class="str">'前端工程师'</span><span class="pun">});</span><span class="pln">
    krouky</span><span class="pun">.</span><span class="pln">findSimilarTypes</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">persons</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//persons中就能查询到其他前端工程师</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####2.2 静态方法</p>
<p>静态方法在<code>Model</code>层就能使用，如下：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">  </span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="pln">statics</span><span class="pun">.</span><span class="pln">findByName </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">cb</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">find</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="str">'i'</span><span class="pun">),</span><span class="pln">cb</span><span class="pun">});</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
  </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">findByName</span><span class="pun">(</span><span class="str">'krouky'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">persons</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//找到所有名字叫krouky的人</span><span class="pln">
  </span><span class="pun">});</span></code></pre><p>####2.3 索引</p>
<p>索引或者复合索引能让搜索更加高效，默认索引就是主键索引<code>ObjectId</code>，属性名为<code>_id</code>， <em>索引会作为一个专题来讲解</em></p>
<p>####2.4 虚拟属性</p>
<p><code>Schema</code>中如果定义了虚拟属性，那么该属性将不写入数据库，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:{</span><span class="pln">
        first</span><span class="pun">:</span><span class="typ">String</span><span class="pun">,</span><span class="pln">
        </span><span class="kwd">last</span><span class="pun">:</span><span class="typ">String</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:{</span><span class="pln">first</span><span class="pun">:</span><span class="str">'krouky'</span><span class="pun">,</span><span class="kwd">last</span><span class="pun">:</span><span class="str">'han'</span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>如果每次想使用全名就得这样</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">krouky</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="pln">first </span><span class="pun">+</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> krouky</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">);</span></code></pre><p>显然这是很麻烦的，我们可以定义<code>虚拟属性</code>：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="kwd">virtual</span><span class="pun">(</span><span class="str">'name.full'</span><span class="pun">).</span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="pln">first </span><span class="pun">+</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="kwd">last</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>那么就能用<code>krouky.name.full</code>来调用全名了，反之如果知道full，也可以反解<code>first</code>和<code>last</code>属性</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="kwd">virtual</span><span class="pun">(</span><span class="str">'name.full'</span><span class="pun">).</span><span class="kwd">set</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">){</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> split </span><span class="pun">=</span><span class="pln"> name</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">' '</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="pln">first </span><span class="pun">=</span><span class="pln"> split</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
      </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="kwd">last</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> split</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({});</span><span class="pln">
    krouky</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="pln">full </span><span class="pun">=</span><span class="pln"> </span><span class="str">'krouky han'</span><span class="pun">;</span><span class="com">//会被自动分解</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">krouky</span><span class="pun">.</span><span class="pln">name</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="com">//krouky</span></code></pre><p>####2.5 配置项</p>
<p>在使用<code>new Schema(config)</code>时，我们可以追加一个参数<code>options</code>来配置<code>Schema</code>的配置，形如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">(</span><span class="pln">config</span><span class="pun">,</span><span class="pln">options</span><span class="pun">);</span></code></pre><p>或者使用</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ExampleSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">(</span><span class="pln">config</span><span class="pun">);</span><span class="pln">
    </span><span class="typ">ExampleSchema</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">option</span><span class="pun">,</span><span class="pln">value</span><span class="pun">);</span></code></pre><p>可供配置项有：<code>safe</code>、<code>strict</code>、<code>capped</code>、<code>versionKey</code>、<code>autoIndex</code></p>
<p>#####2.5.1 safe——安全属性（默认安全）</p>
<p>一般可做如下配置：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">safe</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">});</span></code></pre><p>当然我们也可以这样</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">safe</span><span class="pun">:{</span><span class="pln">j</span><span class="pun">:</span><span class="lit">1</span><span class="pun">,</span><span class="pln">w</span><span class="pun">:</span><span class="lit">2</span><span class="pun">,</span><span class="pln">wtimeout</span><span class="pun">:</span><span class="lit">10000</span><span class="pun">}});</span></code></pre><p><code>j</code>表示做1份日志，<code>w</code>表示做2个副本（尚不明确），超时时间10秒</p>
<p>#####2.5.2 strict——严格配置（默认启用）</p>
<p>确保<code>Entity</code>的值存入数据库前会被自动验证，如果你没有充足的理由，请不要停用，例子：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ThingSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">a</span><span class="pun">:</span><span class="typ">String</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ThingModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Thing'</span><span class="pun">,</span><span class="typ">SchemaSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> thing </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Thing</span><span class="pun">({</span><span class="pln">iAmNotInTheThingSchema</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">});</span><span class="pln">
    thing</span><span class="pun">.</span><span class="pln">save</span><span class="pun">();</span><span class="com">//iAmNotInTheThingSchema这个属性将无法被存储</span></code></pre><p>如果取消严格选项，<code>iAmNotInTheThingSchema</code>将会被存入数据库</p>
<p>该选项也可以在构造实例时使用，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ThingModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Thing'</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> thing1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ThingModel</span><span class="pun">(</span><span class="pln">doc</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">  </span><span class="com">//启用严格</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> thing2 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ThingModel</span><span class="pun">(</span><span class="pln">doc</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">);</span><span class="pln"> </span><span class="com">//禁用严格</span></code></pre><p><strong>注意：</strong></p>
<p><code>strict</code>也可以设置为<code>throw</code>，表示出现问题将会抛出错误</p>
<p>#####2.5.3 shardKey</p>
<p>需要<code>mongodb</code>做分布式，才会使用该属性</p>
<p>#####2.5.4 capped——上限设置</p>
<p>如果有数据库的批量操作，该属性能限制一次操作的量，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">capped</span><span class="pun">:</span><span class="lit">1024</span><span class="pun">});</span><span class="pln">  </span><span class="com">//一次操作上线1024条数据</span></code></pre><p>当然该参数也可是JSON对象，包含size、max、autiIndexId属性</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">capped</span><span class="pun">:{</span><span class="pln">size</span><span class="pun">:</span><span class="lit">1024</span><span class="pun">,</span><span class="pln">max</span><span class="pun">:</span><span class="lit">100</span><span class="pun">,</span><span class="pln">autoIndexId</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}});</span></code></pre><p>#####2.5.5 versionKey——版本锁</p>
<p>版本锁是<code>Mongoose</code>默认配置（__v属性）的，如果你想自己定制，如下：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">versionKey</span><span class="pun">:</span><span class="str">'__someElse'</span><span class="pun">});</span></code></pre><p>此时存入数据库的版本锁就不是<code>__v</code>属性，而是<code>__someElse</code>，相当于是给版本锁取名字。</p>
<p>具体怎么存入都是由<code>Mongoose</code>和<code>MongoDB</code>自己决定，当然，这个属性你也可以去除</p>
<pre class="prettyprint language-javascript"><code><span class="pln">  </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">versionKey</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">});</span></code></pre><p>除非你知道你在做什么，并且你知道这样做的后果</p>
<p>#####2.5.6 autoIndex——自动索引</p>
<p><em>该内容将在索引章节单独讲解</em></p>
<p>###3. Documents</p>
<p><code>Document</code>是与<code>MongoDB</code>文档一一对应的模型，<code>Document</code>可等同于<code>Entity</code>，具有属性和操作性</p>
<p><strong>注意：</strong></p>
<p><code>Document</code>的`CRUD都必须经过严格验证的，参看<strong>2.5.2 Schema的strict严格配置</strong></p>
<p>####3.1 查询</p>
<p>查询内容过多，专题讲解</p>
<p>####3.2 更新</p>
<p>有许多方式来更新文件，以下是常用的传统方式：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">person</span><span class="pun">){</span><span class="pln">
      person</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'MDragon'</span><span class="pun">;</span><span class="pln">
      person</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">){});</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>这里，利用<code>Model</code>模型查询到了<code>person</code>对象，该对象属于<code>Entity</code>，可以有<code>save操作，如果使用</code>Model`操作，需注意：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">person</span><span class="pun">){</span><span class="pln">
      person</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'MDragon'</span><span class="pun">;</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> _id </span><span class="pun">=</span><span class="pln"> person</span><span class="pun">.</span><span class="pln">_id</span><span class="pun">;</span><span class="pln"> </span><span class="com">//需要取出主键_id</span><span class="pln">
      </span><span class="kwd">delete</span><span class="pln"> person</span><span class="pun">.</span><span class="pln">_id</span><span class="pun">;</span><span class="pln">    </span><span class="com">//再将其删除</span><span class="pln">
      </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">update</span><span class="pun">({</span><span class="pln">_id</span><span class="pun">:</span><span class="pln">_id</span><span class="pun">},</span><span class="pln">person</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">){});</span><span class="pln">
      </span><span class="com">//此时才能用Model操作，否则报错</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p><code>update</code>第一个参数是查询条件，第二个参数是更新的对象，但不能更新主键，这就是为什么要删除主键的原因。</p>
<p>当然这样的更新很麻烦，可以使用<code>$set</code>属性来配置，这样也不用先查询，如果更新的数据比较少，可用性还是很好的：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">update</span><span class="pun">({</span><span class="pln">_id</span><span class="pun">:</span><span class="pln">_id</span><span class="pun">},{</span><span class="pln">$set</span><span class="pun">:{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'MDragon'</span><span class="pun">}},</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">){});</span></code></pre><p>需要注意，<code>Document</code>的<code>CRUD</code>操作都是异步执行，<code>callback</code>第一个参数必须是<code>err</code>，而第二个参数各个方法不一样，<code>update</code>的<code>callback</code>第二个参数是更新的数量，如果要返回更新后的对象，则要使用如下方法</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">Person</span><span class="pun">.</span><span class="pln">findByIdAndUpdate</span><span class="pun">(</span><span class="pln">_id</span><span class="pun">,{</span><span class="pln">$set</span><span class="pun">:{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'MDragon'</span><span class="pun">}},</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">person</span><span class="pun">){</span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">person</span><span class="pun">.</span><span class="pln">name</span><span class="pun">);</span><span class="pln"> </span><span class="com">//MDragon</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>类似的方法还有<code>findByIdAndRemove</code>，如同名字，只能根据id查询并作<code>update</code>/<code>remove</code>操作，操作的数据仅一条</p>
<p>####3.3 新增</p>
<p>如果是<code>Entity</code>，使用<code>save</code>方法，如果是<code>Model</code>，使用<code>create</code>方法</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="com">//使用Entity来增加一条数据</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'krouky'</span><span class="pun">});</span><span class="pln">
    krouky</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">callback</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//使用Model来增加一条数据</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">MDragon</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'MDragon'</span><span class="pun">};</span><span class="pln">
    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="typ">MDragon</span><span class="pun">,</span><span class="pln">callback</span><span class="pun">);</span></code></pre><p>两种新增方法区别在于，如果使用<code>Model</code>新增时，传入的对象只能是纯净的<code>JSON</code>对象，不能是由<code>Model</code>创建的实体，原因是：由<code>Model</code>创建的实体<code>krouky</code>虽然打印是只有<code>{name:'krouky'}</code>，但是<code>krouky</code>属于<code>Entity</code>，包含有<code>Schema</code>属性和<code>Model</code>数据库行为模型。如果是使用<code>Model</code>创建的对象，传入时一定会将隐藏属性也存入数据库，虽然<code>3.x</code>追加了默认严格属性，但也不必要增加操作的报错</p>
<p>####3.4 删除</p>
<p>和新增一样，删除也有2种方式，但<code>Entity</code>和<code>Model</code>都使用<code>remove</code>方法</p>
<p>###4.Sub Docs</p>
<p>如同<code>SQL</code>数据库中2张表有主外关系，<code>Mongoose</code>将2个<code>Document</code>的嵌套叫做<code>Sub-Docs</code>（子文档）</p>
<p>简单的说就是一个<code>Document</code>嵌套另外一个<code>Document</code>或者<code>Documents</code>:</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ChildSchema1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="typ">String</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ChildSchema2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="typ">String</span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ParentSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      children1</span><span class="pun">:</span><span class="typ">ChildSchema1</span><span class="pun">,</span><span class="pln">   </span><span class="com">//嵌套Document</span><span class="pln">
      children2</span><span class="pun">:[</span><span class="typ">ChildSchema2</span><span class="pun">]</span><span class="pln">  </span><span class="com">//嵌套Documents</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p><code>Sub-Docs</code>享受和<code>Documents</code>一样的操作，但是<code>Sub-Docs</code>的操作都由父类去执行</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ParentModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Parent'</span><span class="pun">,</span><span class="pln">parentSchema</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> parent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ParentModel</span><span class="pun">({</span><span class="pln">
      children2</span><span class="pun">:[{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'c1'</span><span class="pun">},{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'c2'</span><span class="pun">}]</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    parent</span><span class="pun">.</span><span class="pln">children2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'d'</span><span class="pun">;</span><span class="pln">
    parent</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">callback</span><span class="pun">);</span></code></pre><p><code>parent</code>在执行保存时，由于包含<code>children2</code>，他是一个数据库模型对象，因此会先保存<code>chilren2[0]</code>和<code>chilren2[1]</code>。</p>
<p>如果子文档在更新时出现错误，将直接报在父类文档中，可以这样处理：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">ChildrenSchema</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">(</span><span class="str">'save'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">){</span><span class="pln">
      </span><span class="kwd">if</span><span class="pun">(</span><span class="str">'x'</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(</span><span class="str">'#err:not-x'</span><span class="pun">));</span><span class="pln">
      </span><span class="kwd">next</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> parent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ParentModel</span><span class="pun">({</span><span class="pln">children1</span><span class="pun">:{</span><span class="pln">name</span><span class="pun">:</span><span class="str">'not-x'</span><span class="pun">}});</span><span class="pln">
    parent</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">){</span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">err</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln"> </span><span class="com">//#err:not-x</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####4.1 查询子文档</p>
<p>如果<code>children</code>是<code>parent</code>的子文档，可以通过如下方法查询到<code>children</code></p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> child </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">children</span><span class="pun">.</span><span class="pln">id</span><span class="pun">(</span><span class="pln">id</span><span class="pun">);</span></code></pre><p>####4.2 新增、删除、更新</p>
<p>子文档是父文档的一个属性，因此按照属性的操作即可，不同的是在新增父类的时候，子文档是会被先加入进去的。</p>
<p>如果<code>ChildrenSchema</code>是临时的一个子文档，不作为数据库映射集合，可以这样：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">ParentSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      children</span><span class="pun">:{</span><span class="pln">
        name</span><span class="pun">:</span><span class="typ">String</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    </span><span class="com">//其实就是匿名混合模式</span></code></pre><p>###5.Model</p>
<p>####5.1 什么是Model</p>
<p><code>Model</code>模型，是经过<code>Schema</code>构造来的，除了<code>Schema</code>定义的数据库骨架以外，还具有数据库行为模型，他相当于管理数据库属性、行为的类</p>
<p>####5.2 如何创建Model</p>
<p>你必须通过<code>Schema</code>来创建，如下：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="com">//先创建Schema</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">TankSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:</span><span class="str">'String'</span><span class="pun">,</span><span class="pln">
      size</span><span class="pun">:</span><span class="str">'String'</span><span class="pln"> 
    </span><span class="pun">});</span><span class="pln">
    </span><span class="com">//通过Schema创建Model</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">TankModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Tank'</span><span class="pun">,</span><span class="typ">TankSchema</span><span class="pun">);</span></code></pre><p>####5.2 操作Model</p>
<p>该模型就能直接拿来操作，具体查看<code>API</code>，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> tank </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'something'</span><span class="pun">,</span><span class="pln">size</span><span class="pun">:</span><span class="str">'small'</span><span class="pun">};</span><span class="pln">
    </span><span class="typ">TankModel</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">tank</span><span class="pun">);</span></code></pre><p><strong>注意：</strong></p>
<p>你可以使用<code>Model</code>来创建<code>Entity</code>，<code>Entity</code>实体是一个特有<code>Model</code>具体对象，但是他并不具备<code>Model</code>的方法，只能用自己的方法。</p>
<pre class="prettyprint language-javascript"><code><span class="pln">  </span><span class="com">//通过Model创建Entity</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> tankEntity </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">TankModel</span><span class="pun">(</span><span class="str">'someother'</span><span class="pun">,</span><span class="str">'size:big'</span><span class="pun">);</span><span class="pln">
  tankEntity</span><span class="pun">.</span><span class="pln">save</span><span class="pun">();</span></code></pre><p>###6.Query</p>
<p>查询是数据库中运用最多也是最麻烦的地方，这里对<code>Query</code>解读的并不完善，仅仅是自己的一点领悟而已。</p>
<p>####6.1 查询的方式</p>
<p>通常有2种查询方式，一种是<code>直接查询</code>，一种是<code>链式查询</code>（2种查询都是自己命名的）</p>
<p>#####6.1.1 直接查询</p>
<p>在查询时带有回调函数的，称之为直接查询，查询的条件往往通过<code>API</code>来设定，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">findOne</span><span class="pun">({</span><span class="str">'name.last'</span><span class="pun">:</span><span class="str">'dragon'</span><span class="pun">},</span><span class="str">'some select'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">person</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//如果err==null，则person就能取到数据</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>具体的查询参数，请查询<code>API</code></p>
<p>#####6.1.2 链式查询</p>
<p>在查询时候，不带回调，而查询条件通过<code>API</code>函数来制定，例如：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">findOne</span><span class="pun">({</span><span class="str">'name.last'</span><span class="pun">:</span><span class="str">'dragon'</span><span class="pun">});</span><span class="pln">
    query</span><span class="pun">.</span><span class="kwd">select</span><span class="pun">(</span><span class="str">'some select'</span><span class="pun">);</span><span class="pln">
    query</span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">pserson</span><span class="pun">){</span><span class="pln">
    </span><span class="com">//如果err==null，则person就能取到数据</span><span class="pln">
  </span><span class="pun">});</span></code></pre><p>这种方式相对直接查询，分的比较明细，如果不带<code>callback</code>，则返回<code>query</code>，<code>query</code>没有执行的预编译查询语句，该<code>query</code>对象执行的方法都将返回自己，只有在执行<code>exec</code>方法时才执行查询，而且必须有回调。</p>
<p>因为<code>query</code>的操作始终返回自身，我们可以采用更形象的链式写法</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="typ">Person</span><span class="pln">
      </span><span class="pun">.</span><span class="pln">find</span><span class="pun">({</span><span class="pln"> occupation</span><span class="pun">:</span><span class="pln"> </span><span class="str">/host/</span><span class="pln"> </span><span class="pun">})</span><span class="pln">
      </span><span class="pun">.</span><span class="kwd">where</span><span class="pun">(</span><span class="str">'name.last'</span><span class="pun">).</span><span class="pln">equals</span><span class="pun">(</span><span class="str">'Ghost'</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">.</span><span class="kwd">where</span><span class="pun">(</span><span class="str">'age'</span><span class="pun">).</span><span class="pln">gt</span><span class="pun">(</span><span class="lit">17</span><span class="pun">).</span><span class="pln">lt</span><span class="pun">(</span><span class="lit">66</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">.</span><span class="kwd">where</span><span class="pun">(</span><span class="str">'likes'</span><span class="pun">).</span><span class="kwd">in</span><span class="pun">([</span><span class="str">'vaporizing'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'talking'</span><span class="pun">])</span><span class="pln">
      </span><span class="pun">.</span><span class="pln">limit</span><span class="pun">(</span><span class="lit">10</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="str">'-occupation'</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">.</span><span class="kwd">select</span><span class="pun">(</span><span class="str">'name occupation'</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">.</span><span class="kwd">exec</span><span class="pun">(</span><span class="pln">callback</span><span class="pun">);</span></code></pre><p>###7.Validation</p>
<p>数据的存储是需要验证的，不是什么数据都能往数据库里丢或者显示到客户端的，数据的验证需要记住以下规则：</p>
<ul>
<li>验证始终定义在<code>SchemaType</code>中</li>
<li>验证是一个内部中间件</li>
<li>验证是在一个<code>Document</code>被保存时默认启用的，除非你关闭验证</li>
<li>验证是异步递归的，如果你的<code>SubDoc</code>验证失败，<code>Document</code>也将无法保存</li>
<li>验证并不关心错误类型，而通过<code>ValidationError</code>这个对象可以访问</li>
</ul>
<p>####7.1 验证器</p>
<ol>
<li><code>required</code> 非空验证</li>
<li><code>min</code>/<code>max</code> 范围验证（边值验证）</li>
<li><code>enum</code>/<code>match</code> 枚举验证/匹配验证</li>
<li><code>validate</code> 自定义验证规则</li>
</ol>
<p>以下是综合案例：</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:{</span><span class="pln">
        type</span><span class="pun">:</span><span class="str">'String'</span><span class="pun">,</span><span class="pln">
        required</span><span class="pun">:</span><span class="kwd">true</span><span class="pln"> </span><span class="com">//姓名非空</span><span class="pln">
      </span><span class="pun">},</span><span class="pln">
      age</span><span class="pun">:{</span><span class="pln">
        type</span><span class="pun">:</span><span class="str">'Nunmer'</span><span class="pun">,</span><span class="pln">
        min</span><span class="pun">:</span><span class="lit">18</span><span class="pun">,</span><span class="pln">       </span><span class="com">//年龄最小18</span><span class="pln">
        max</span><span class="pun">:</span><span class="lit">120</span><span class="pln">     </span><span class="com">//年龄最大120</span><span class="pln">
      </span><span class="pun">},</span><span class="pln">
      city</span><span class="pun">:{</span><span class="pln">
        type</span><span class="pun">:</span><span class="str">'String'</span><span class="pun">,</span><span class="pln">
        </span><span class="kwd">enum</span><span class="pun">:[</span><span class="str">'北京'</span><span class="pun">,</span><span class="str">'上海'</span><span class="pun">]</span><span class="pln">  </span><span class="com">//只能是北京、上海人</span><span class="pln">
      </span><span class="pun">},</span><span class="pln">
      other</span><span class="pun">:{</span><span class="pln">
        type</span><span class="pun">:</span><span class="str">'String'</span><span class="pun">,</span><span class="pln">
        validate</span><span class="pun">:[</span><span class="pln">validator</span><span class="pun">,</span><span class="pln">err</span><span class="pun">]</span><span class="pln">  </span><span class="com">//validator是一个验证函数，err是验证失败的错误信息</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####7.2 验证失败</p>
<p>如果验证失败，则会返回<code>err</code>信息，<code>err</code>是一个对象该对象属性如下</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    err</span><span class="pun">.</span><span class="pln">errors                </span><span class="com">//错误集合（对象）</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">.</span><span class="pln">color          </span><span class="com">//错误属性(Schema的color属性)</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">.</span><span class="pln">color</span><span class="pun">.</span><span class="pln">message  </span><span class="com">//错误属性信息</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">.</span><span class="pln">path             </span><span class="com">//错误属性路径</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">.</span><span class="pln">type             </span><span class="com">//错误类型</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">name                </span><span class="com">//错误名称</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">message                 </span><span class="com">//错误消息</span></code></pre><p>一旦验证失败，<code>Model</code>和<code>Entity</code>都将具有和<code>err</code>一样的<code>errors</code>属性</p>
<p>###8.Middleware中间件</p>
<p>####8.1 什么是中间件</p>
<p>中间件是一种控制函数，类似插件，能控制流程中的<code>init</code>、validate<code>、</code>save<code>、</code>remove`方法</p>
<p>####8.2 中间件的分类</p>
<p>中间件分为两类</p>
<p>#####8.2.1 Serial串行</p>
<p>串行使用<code>pre</code>方法，执行下一个方法使用<code>next</code>调用</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> schema </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">(...);</span><span class="pln">
    schema</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">(</span><span class="str">'save'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//做点什么</span><span class="pln">
      </span><span class="kwd">next</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>#####8.2.2 Parallel并行</p>
<p>并行提供更细粒度的操作</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> schema </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">(...);</span><span class="pln">
    schema</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">(</span><span class="str">'save'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">,</span><span class="kwd">done</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//下一个要执行的中间件并行执行</span><span class="pln">
      </span><span class="kwd">next</span><span class="pun">();</span><span class="pln">
      doAsync</span><span class="pun">(</span><span class="kwd">done</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>####8.3 中间件特点</p>
<p>一旦定义了中间件，就会在全部中间件执行完后执行其他操作，使用中间件可以雾化模型，避免异步操作的层层迭代嵌套</p>
<p>####8.4 使用范畴</p>
<ol>
<li>复杂的验证</li>
<li>删除有主外关联的<code>doc</code></li>
<li>异步默认</li>
<li>某个特定动作触发异步任务，例如触发自定义事件和通知</li>
</ol>
<p>例如，可以用来做自定义错误处理</p>
<pre class="prettyprint language-javascript"><code><span class="pln">    schema</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">(</span><span class="str">'save'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">){</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> err </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Eerror</span><span class="pun">(</span><span class="str">'some err'</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">err</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    entity</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">){</span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">err</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln"> </span><span class="com">//some err</span><span class="pln">
    </span><span class="pun">});</span></code></pre></div>
      </div>
    </div>
  </div>
  
  <div class="panel">
    <div class="header">
      <span class="col_fade">114 回复</span>
    </div>
    <div class="cell reply_area reply_item
  " reply_id="504b4a05e2b8451577010ccb" reply_to_id="" id="504b4a05e2b8451577010ccb">
  <div class="author_content">
    <a href="http://cnodejs.org/user/a272121742" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/a272121742">a272121742</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#504b4a05e2b8451577010ccb">1楼•5 年前</a>
      
        <span class="reply_by_author">作者</span>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          2
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-a272121742">
    <div class="markdown-text"><p>唉，第一次尝试用markdown写个东西然后发布看看效果，没想到各个在线markdown编辑器的兼容性都不太一样。这是3.x发布的时候我看api写的读后感，作为整理学习的一个东西给我朋友学习的，现在借此机会用markdown发布了，都是很基础的，请随便吐槽。
ps：尝试了各个在线编辑器，花了我一天的时间，都兼容了，不知道咋的，放在nae上就有很多显示不出来。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="504b5dede2b845157701e252" reply_to_id="" id="504b5dede2b845157701e252">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jiyinyiyong" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/449224" title="jiyinyiyong"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jiyinyiyong">jiyinyiyong</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#504b5dede2b845157701e252">2楼•5 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jiyinyiyong">
    <div class="markdown-text"><p>感谢分享, 果断收藏.
这边的 md 版本是 Github 的, 和标准 md 细微不同.</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="504b66a7e2b845157702535d" reply_to_id="" id="504b66a7e2b845157702535d">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jamshen" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/8b40a8a6176ba913a46c0fc654e6f517" title="jamshen"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jamshen">jamshen</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#504b66a7e2b845157702535d">3楼•5 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jamshen">
    <div class="markdown-text"><p>不错，学习</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="504be578e2b845157705afb5" reply_to_id="" id="504be578e2b845157705afb5">
  <div class="author_content">
    <a href="http://cnodejs.org/user/rekey" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3b65e6b2c21a4b98418aad2477aadaf2" title="rekey"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/rekey">rekey</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#504be578e2b845157705afb5">4楼•5 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-rekey">
    <div class="markdown-text"><p>真心是干货.</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51ab059a555d34c6785c730b" reply_to_id="" id="51ab059a555d34c6785c730b">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ruoyu" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/27c8175008af94230ac4820588f9f7e9" title="ruoyu"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ruoyu">ruoyu</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51ab059a555d34c6785c730b">5楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ruoyu">
    <div class="markdown-text"><p>排版好乱</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51affd48555d34c678e00bfd" reply_to_id="51ab059a555d34c6785c730b" id="51affd48555d34c678e00bfd">
  <div class="author_content">
    <a href="http://cnodejs.org/user/a272121742" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/a272121742">a272121742</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51affd48555d34c678e00bfd">6楼•4 年前</a>
      
        <span class="reply_by_author">作者</span>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-a272121742">
    <div class="markdown-text"><p>哎，换了布局之后就乱了，之前都是好的。说明md的语法必须按照标准写才能在各种环境下显示正确。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51affe14555d34c678e050c8" reply_to_id="51ab059a555d34c6785c730b" id="51affe14555d34c678e050c8">
  <div class="author_content">
    <a href="http://cnodejs.org/user/a272121742" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/a272121742">a272121742</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51affe14555d34c678e050c8">7楼•4 年前</a>
      
        <span class="reply_by_author">作者</span>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-a272121742">
    <div class="markdown-text"><p>看了看，量很大，今天得花点时间重新整理布局了~</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51b011f9555d34c678e25f8f" reply_to_id="" id="51b011f9555d34c678e25f8f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/bigmusic" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/29cdb0cacd1ff6eaec35b5d40c95a518" title="bigmusic"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/bigmusic">bigmusic</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51b011f9555d34c678e25f8f">8楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-bigmusic">
    <div class="markdown-text"><p>收藏了</p>
<p>因为在winx64的编译问题,已暂时放弃MongoDB,转用更容易编译的Redis</p>
<p>买了Mac回头再品味LZ大作</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51bc3fa160af11cd33386564" reply_to_id="" id="51bc3fa160af11cd33386564">
  <div class="author_content">
    <a href="http://cnodejs.org/user/yakczh" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6591466" title="yakczh"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/yakczh">yakczh</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51bc3fa160af11cd33386564">9楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-yakczh">
    <div class="markdown-text"><pre class="prettyprint language-A"><code><span class="pln">   </span><span class="kwd">var</span><span class="pln"> mongoose </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'mongoose'</span><span class="pun">);</span><span class="pln">    </span><span class="com">//引用mongoose模块</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">createConnection</span><span class="pun">(</span><span class="str">'localhost'</span><span class="pun">,</span><span class="str">'test'</span><span class="pun">);</span><span class="pln"> </span><span class="com">//创建一个数据库连接</span><span class="pln">
  </span><span class="com">//  console.log(db);</span><span class="pln">
             </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
      name</span><span class="pun">:</span><span class="typ">String</span><span class="pln">   </span><span class="com">//定义一个属性name，类型为String</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    
     </span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">  
    db</span><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">'error'</span><span class="pun">,</span><span class="pln">console</span><span class="pun">.</span><span class="pln">error</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="pln">console</span><span class="pun">,</span><span class="str">'连接错误:'</span><span class="pun">));</span><span class="pln">
    db</span><span class="pun">.</span><span class="pln">once</span><span class="pun">(</span><span class="str">'open'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
      </span><span class="com">//一次打开记录</span><span class="pln">
        console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"openned"</span><span class="pun">);</span><span class="pln">
        

    
      </span><span class="kwd">var</span><span class="pln"> personEntity </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'zKrxxxouky'</span><span class="pun">});</span><span class="pln">
         personEntity</span><span class="pun">.</span><span class="pln">save</span><span class="pun">();</span><span class="pln">
       
        </span><span class="typ">PersonModel</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln">persons</span><span class="pun">){</span><span class="pln">
      </span><span class="com">//查询到的所有person</span><span class="pln">
            console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">err</span><span class="pun">);</span><span class="pln">
            console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">persons</span><span class="pun">);</span><span class="pln">
              db</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
   
    </span><span class="pun">});</span><span class="pln">
  </span></code></pre><p>上面的代码运行以后,mongodb里竞然是一个people的collection,  好奇怪</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51bef23e52997eac1e00c186" reply_to_id="51bc3fa160af11cd33386564" id="51bef23e52997eac1e00c186">
  <div class="author_content">
    <a href="http://cnodejs.org/user/a272121742" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/a272121742">a272121742</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51bef23e52997eac1e00c186">10楼•4 年前</a>
      
        <span class="reply_by_author">作者</span>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-a272121742">
    <div class="markdown-text"><p>你好，你的代码我复制之后直接运行，结果如下：</p>
<pre class="prettyprint"><code><span class="pln">E</span><span class="pun">:</span><span class="pln">\&gt;node mongoosetest</span><span class="pun">.</span><span class="pln">js
openned
</span><span class="kwd">null</span><span class="pln">
</span><span class="pun">[</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> </span><span class="str">'zKrxxxouky'</span><span class="pun">,</span><span class="pln"> _id</span><span class="pun">:</span><span class="pln"> </span><span class="lit">51beef02cf514a100f000001</span><span class="pun">,</span><span class="pln"> __v</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pln">

E</span><span class="pun">:</span><span class="pln">\&gt;</span></code></pre><p>我查阅数据库，结果如下：</p>
<pre class="prettyprint"><code><span class="pln">E</span><span class="pun">:</span><span class="pln">\&gt;mongo
</span><span class="typ">MongoDB</span><span class="pln"> shell version</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.4</span><span class="pun">.</span><span class="lit">1</span><span class="pln">
connecting to</span><span class="pun">:</span><span class="pln"> test
</span><span class="typ">Server</span><span class="pln"> has startup warnings</span><span class="pun">:</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> NOTE</span><span class="pun">:</span><span class="pln"> </span><span class="typ">This</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> a </span><span class="lit">32</span><span class="pln"> bit </span><span class="typ">MongoDB</span><span class="pln"> binary</span><span class="pun">.</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln">       </span><span class="lit">32</span><span class="pln"> bit builds are limited to less than </span><span class="lit">2GB</span><span class="pln"> of data </span><span class="pun">(</span><span class="kwd">or</span><span class="pln"> less </span><span class="kwd">with</span><span class="pln"> </span><span class="pun">--</span><span class="pln">journal</span><span class="pun">).</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln">       </span><span class="typ">Note</span><span class="pln"> that journaling defaults to off </span><span class="kwd">for</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> bit </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> currently off</span><span class="pun">.</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln">       </span><span class="typ">See</span><span class="pln"> http</span><span class="pun">:</span><span class="com">//dochub.mongodb.org/core/32bit</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> NOTE</span><span class="pun">:</span><span class="pln"> your operating system version does </span><span class="kwd">not</span><span class="pln"> support the method that </span><span class="typ">MongoDB</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln">       uses to detect impending page faults</span><span class="pun">.</span><span class="pln">
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln">       </span><span class="typ">This</span><span class="pln"> may result </span><span class="kwd">in</span><span class="pln"> slower performance </span><span class="kwd">for</span><span class="pln"> certain </span><span class="kwd">use</span><span class="pln"> cases
</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">18</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">24.218</span><span class="pln"> </span><span class="pun">[</span><span class="pln">initandlisten</span><span class="pun">]</span><span class="pln">
</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">use</span><span class="pln"> test
switched to db test
</span><span class="pun">&gt;</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">person</span><span class="pun">.</span><span class="pln">find</span><span class="pun">();</span><span class="pln">
</span><span class="pun">{</span><span class="pln"> </span><span class="str">"name"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"zKrxxxouky"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"_id"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">ObjectId</span><span class="pun">(</span><span class="str">"51beef02cf514a100f000001"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"__v"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">}</span></code></pre><p>使用rock查阅数据库可视化界面如图：</p>
<p><img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3166874963071774051.png" alt="图片"></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51bf3d8cdc0c7f7f3802933b" reply_to_id="" id="51bf3d8cdc0c7f7f3802933b">
  <div class="author_content">
    <a href="http://cnodejs.org/user/chemdemo" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1014734" title="chemdemo"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/chemdemo">chemdemo</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51bf3d8cdc0c7f7f3802933b">11楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-chemdemo">
    <div class="markdown-text"><p>干货啊，谢谢分享！！！</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="51c04e9a57628b975f095d1f" reply_to_id="" id="51c04e9a57628b975f095d1f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/langziguilai" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/49d35acb266e4c6ee4125a8cd8f7038f" title="langziguilai"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/langziguilai">langziguilai</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#51c04e9a57628b975f095d1f">12楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          1
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-langziguilai">
    <div class="markdown-text"><p>写得非常好，受教了</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5253794df29c7bbd3caaf8f1" reply_to_id="" id="5253794df29c7bbd3caaf8f1">
  <div class="author_content">
    <a href="http://cnodejs.org/user/minishine" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/98e1b8427368bca5109fc7f48a2bf544" title="minishine"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/minishine">minishine</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5253794df29c7bbd3caaf8f1">13楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-minishine">
    <div class="markdown-text"><p>楼主是好人</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5253ad56f29c7bbd3cb20657" reply_to_id="" id="5253ad56f29c7bbd3cb20657">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jabez128" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/970f5e4ca83c6c356d7fd6660e681bbc" title="jabez128"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jabez128">jabez128</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5253ad56f29c7bbd3cb20657">14楼•4 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jabez128">
    <div class="markdown-text"><p>赞美楼主！</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5289bf12d2b3893f2a5a7eba" reply_to_id="" id="5289bf12d2b3893f2a5a7eba">
  <div class="author_content">
    <a href="http://cnodejs.org/user/whwnow" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1e5d9c6016f0790467b54d7fb20f5000" title="whwnow"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/whwnow">whwnow</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5289bf12d2b3893f2a5a7eba">15楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-whwnow">
    <div class="markdown-text"><p>赞美楼主!</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="528f434ba49576a26d15f570" reply_to_id="51bc3fa160af11cd33386564" id="528f434ba49576a26d15f570">
  <div class="author_content">
    <a href="http://cnodejs.org/user/pollow" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1d22958071e4fd91be439330d0b94f14" title="pollow"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/pollow">pollow</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#528f434ba49576a26d15f570">16楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-pollow">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/a272121742" target="_blank">@a272121742</a></p>
<p>很奇怪，我复制执行了以后也是 people 的一个 collection</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5294bb7fa6957a08098f237e" reply_to_id="" id="5294bb7fa6957a08098f237e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xialvjun" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/cc41a17dd4afb6e12c9321e3755e1911" title="xialvjun"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xialvjun">xialvjun</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5294bb7fa6957a08098f237e">17楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xialvjun">
    <div class="markdown-text"><p>赞美楼主先，不过，如果一个项目只能有一个链接，那如果项目很大怎么办。 我知道可以把那些schema什么的都定义在外面，然后用exports、module差不多了，不过有没有什么正规的方法啊，比如使用什么什么模式，，，，一些官方推介的例子用的方法。。在mongoose的官网看api，看老半天，他们的例子也是很简单的一句，假设下面的代码都在回调中。。。。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52954595a6957a080997d869" reply_to_id="5294bb7fa6957a08098f237e" id="52954595a6957a080997d869">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ggaaooppeenngg" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/4769989" title="ggaaooppeenngg"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ggaaooppeenngg">ggaaooppeenngg</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52954595a6957a080997d869">18楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ggaaooppeenngg">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/xialvjun" target="_blank">@xialvjun</a>
没看明白你说什么，举个例子，上个code</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52954dc8a6957a0809992dc4" reply_to_id="5294bb7fa6957a08098f237e" id="52954dc8a6957a0809992dc4">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xialvjun" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/cc41a17dd4afb6e12c9321e3755e1911" title="xialvjun"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xialvjun">xialvjun</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52954dc8a6957a0809992dc4">19楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xialvjun">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/ggaaooppeenngg" target="_blank">@ggaaooppeenngg</a></p>
<p>抱歉啊，还真没什么code，只是楼主这文章中不是有两句话吗，“在项目只能够创建一个数据库连接”和“假设以下代码都在回调中处理”，这样的话，虽然我们可以把schema定义在别的js文件中，但是那些entity.save/update等各种要操作数据库的代码就要放在这个回调中了，那样一定会很乱吧。。。
我们一般做项目不都是分层的吗，什么DAO层什么的，然后DAO层要有对应的模型，例如建博客网站，那要有blog模型，user模型，这些模型在mongoose里就是schema、model吧，我们一般不应该是一个模型一个文件吗，然后往往对数据库的操作也是封装到模型中去了啊，那些entity.save/update就是模型对数据库的操作。
可是这些操作必须放在</p>
<pre class="prettyprint language- js"><code><span class="pln">db</span><span class="pun">.</span><span class="pln">once</span><span class="pun">(</span><span class="str">'open'</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
      </span><span class="com">//一次打开记录</span><span class="pln">
    </span><span class="pun">});</span></code></pre><p>的回调里，那不会很乱吗？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52955608a6957a08099a5f13" reply_to_id="5294bb7fa6957a08098f237e" id="52955608a6957a08099a5f13">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xialvjun" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/cc41a17dd4afb6e12c9321e3755e1911" title="xialvjun"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xialvjun">xialvjun</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52955608a6957a08099a5f13">20楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xialvjun">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/ggaaooppeenngg" target="_blank">@ggaaooppeenngg</a></p>
<p>我好像犯了一个很2的问题，刚才看了一下mongoose官网首页，首页上的那段代码</p>
<pre class="prettyprint language- js"><code><span class="kwd">var</span><span class="pln"> mongoose </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'mongoose'</span><span class="pun">);</span><span class="pln">
mongoose</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">(</span><span class="str">'mongodb://localhost/test'</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> </span><span class="typ">Cat</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Cat'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">});</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> kitty </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Cat</span><span class="pun">({</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Zildjian'</span><span class="pln"> </span><span class="pun">});</span><span class="pln">
kitty</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln"> </span><span class="com">// ...</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'meow'</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></code></pre><p>这段代码是可以运行的，虽然没有db.once(‘open’,function(){}),不过好像没关系。。。
那这个</p>
<pre class="prettyprint language- js"><code><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">createConnection</span><span class="pun">(</span><span class="str">'localhost'</span><span class="pun">,</span><span class="str">'test'</span><span class="pun">);</span><span class="pln"> </span><span class="com">//创建一个数据库连接</span></code></pre><p>的db是干嘛用的，好吧，什么问题都没有了，谢谢有人关注回答，我需要再了解一下mongoose.createConnection的返回值，去看官方文档了。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52955a05a6957a08099aef5a" reply_to_id="5294bb7fa6957a08098f237e" id="52955a05a6957a08099aef5a">
  <div class="author_content">
    <a href="http://cnodejs.org/user/a272121742" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b087595f7b1a3801718f7a04d24add89" title="a272121742"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/a272121742">a272121742</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52955a05a6957a08099aef5a">21楼•3 年前</a>
      
        <span class="reply_by_author">作者</span>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          2
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-a272121742">
    <div class="markdown-text"><p>使用连接池，mongoose官方说是以后会加的，现在更新到哪了我也没关注过了，连接池github上有很多的</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52955aafa6957a08099b1490" reply_to_id="" id="52955aafa6957a08099b1490">
  <div class="author_content">
    <a href="http://cnodejs.org/user/zhangran" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/a3e3f34a0e79a03b24aec01b40449a4d" title="zhangran"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/zhangran">zhangran</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52955aafa6957a08099b1490">22楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-zhangran">
    <div class="markdown-text"><p>mark一下周末看看</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52956b96a6957a08099de192" reply_to_id="5294bb7fa6957a08098f237e" id="52956b96a6957a08099de192">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ggaaooppeenngg" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/4769989" title="ggaaooppeenngg"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ggaaooppeenngg">ggaaooppeenngg</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52956b96a6957a08099de192">23楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          1
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ggaaooppeenngg">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/xialvjun" target="_blank">@xialvjun</a>
我写的话一般，一个模型就一个model，在app.js链接数据库以后,再用model操作，moongoose是装了链接数据库的操作的，db这个应该不用管吧，我也没具体用过这个。
我记得以前发了一个get start 的翻译篇，对这个楼主的文章补充了一下，希望对你有帮助。
<a href="http://cnodejs.org/topic/5206581b44e76d216aae072e" target="_blank">http://cnodejs.org/topic/5206581b44e76d216aae072e</a>
具体的API还是看moongoose的主页吧。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5295766fa6957a08099f0cec" reply_to_id="" id="5295766fa6957a08099f0cec">
  <div class="author_content">
    <a href="http://cnodejs.org/user/fsiaonma" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1947494" title="fsiaonma"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/fsiaonma">fsiaonma</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5295766fa6957a08099f0cec">24楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-fsiaonma">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52a14599a6957a0809ea7d42" reply_to_id="" id="52a14599a6957a0809ea7d42">
  <div class="author_content">
    <a href="http://cnodejs.org/user/qinpengfei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5b2ffae0e2cade48ce68474b7742dd65" title="qinpengfei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/qinpengfei">qinpengfei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52a14599a6957a0809ea7d42">25楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-qinpengfei">
    <div class="markdown-text"><h1>mark</h1>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52c650038a716e0b152feca2" reply_to_id="" id="52c650038a716e0b152feca2">
  <div class="author_content">
    <a href="http://cnodejs.org/user/nodejsforme" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/c45a64186a3d7cd8db4105f88a93370a" title="nodejsforme"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/nodejsforme">nodejsforme</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52c650038a716e0b152feca2">26楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-nodejsforme">
    <div class="markdown-text"><p>真心干货啊！！！！</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52e7157c78990b041163dbe0" reply_to_id="" id="52e7157c78990b041163dbe0">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jay61439476" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/2d1ef4744c416d47fa77faf25040f71a" title="jay61439476"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jay61439476">jay61439476</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52e7157c78990b041163dbe0">27楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jay61439476">
    <div class="markdown-text"><p>请教一下， 我使用mongoose放我一个我现有的mongodb, _id是自定义的字符串，28位，一直没有查询成功，
会有这种报错： CastError: Cast to ObjectId failed for value “QP41024724_3400_140127110035” at path "_id"
转换之后仍然报错
var id = mongoose.Types.ObjectId(<a href="http://req.params.id/" target="_blank">req.params.id</a>)
=&gt;
Error: Argument passed in must be a single String of 12 bytes or a string of 24 hex characters</p>
<p>求教。。。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52f48e301b80994b0d340e3a" reply_to_id="" id="52f48e301b80994b0d340e3a">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ceclinux" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/c94496ed19500aeba409f129e935717e" title="ceclinux"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ceclinux">ceclinux</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52f48e301b80994b0d340e3a">28楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ceclinux">
    <div class="markdown-text"><p>有一点打错了，
<code>mothos</code>应该为<code>methods</code><br>
感谢～</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="52f737041b80994b0d7cebe1" reply_to_id="" id="52f737041b80994b0d7cebe1">
  <div class="author_content">
    <a href="http://cnodejs.org/user/duni2013" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/69578ed4d0ddc3ac41c8286619c6429d" title="duni2013"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/duni2013">duni2013</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#52f737041b80994b0d7cebe1">29楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-duni2013">
    <div class="markdown-text"><p>写的不错，不过有些东西太模糊了，比如：
2.5.1 safe——安全属性（默认安全）</p>
<p>一般可做如下配置：</p>
<pre class="prettyprint"><code><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({...},{</span><span class="pln">safe</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">});</span></code></pre><p>当然我们也可以这样</p>
<p>这个到底有啥用，没有说明白，查文档，才知道，如果设置成true就是在操作的时候要等待返回的Mongo返回的结果，比如update，要返回影响的条数，才往后执行，如果safe：false，则表示不用等到结果就向后执行了。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="531923b388ad4a0e13016508" reply_to_id="" id="531923b388ad4a0e13016508">
  <div class="author_content">
    <a href="http://cnodejs.org/user/usherwong" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1889378" title="usherwong"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/usherwong">usherwong</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#531923b388ad4a0e13016508">30楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-usherwong">
    <div class="markdown-text"><p>好东西，感谢楼主</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="532a4f77ca272abd500042c9" reply_to_id="" id="532a4f77ca272abd500042c9">
  <div class="author_content">
    <a href="http://cnodejs.org/user/demohi" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1209159" title="demohi"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/demohi">demohi</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#532a4f77ca272abd500042c9">31楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-demohi">
    <div class="markdown-text"><p>好文 点赞</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="532aa28527515a4d58028493" reply_to_id="" id="532aa28527515a4d58028493">
  <div class="author_content">
    <a href="http://cnodejs.org/user/liubaiyang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/aa7ce50088a30c2e01ee4f72083a5692" title="liubaiyang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/liubaiyang">liubaiyang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#532aa28527515a4d58028493">32楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-liubaiyang">
    <div class="markdown-text"><p>太好了  谢谢楼主分享</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="532aa2cb27515a4d5802985f" reply_to_id="532aa28527515a4d58028493" id="532aa2cb27515a4d5802985f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/liubaiyang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/aa7ce50088a30c2e01ee4f72083a5692" title="liubaiyang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/liubaiyang">liubaiyang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#532aa2cb27515a4d5802985f">33楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-liubaiyang">
    <div class="markdown-text"><p>周末看看</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="532dbcbb95db4c2478008f9c" reply_to_id="" id="532dbcbb95db4c2478008f9c">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xiaowudesign" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3508855" title="xiaowudesign"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xiaowudesign">xiaowudesign</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#532dbcbb95db4c2478008f9c">34楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xiaowudesign">
    <div class="markdown-text"><p>很棒！我先make一下～</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="532eedf47ed059b90500f493" reply_to_id="" id="532eedf47ed059b90500f493">
  <div class="author_content">
    <a href="http://cnodejs.org/user/yreenchan" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3251726" title="yreenchan"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/yreenchan">yreenchan</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#532eedf47ed059b90500f493">35楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          2
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-yreenchan">
    <div class="markdown-text"><p>很赞！！总结的很不错</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5333d520734cf22a31028d82" reply_to_id="" id="5333d520734cf22a31028d82">
  <div class="author_content">
    <a href="http://cnodejs.org/user/Pana" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/552081" title="Pana"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/Pana">Pana</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5333d520734cf22a31028d82">36楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-Pana">
    <div class="markdown-text"><p>好东西, 收藏</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5333dd79d9b2aea0310054dc" reply_to_id="" id="5333dd79d9b2aea0310054dc">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xrfinbupt" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/919472" title="xrfinbupt"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xrfinbupt">xrfinbupt</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5333dd79d9b2aea0310054dc">37楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xrfinbupt">
    <div class="markdown-text"><p>good</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="533cd2e586c030590402b871" reply_to_id="" id="533cd2e586c030590402b871">
  <div class="author_content">
    <a href="http://cnodejs.org/user/owen-hong" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6466628" title="owen-hong"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/owen-hong">owen-hong</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#533cd2e586c030590402b871">38楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-owen-hong">
    <div class="markdown-text"><p>文章中的代码有太多的错误，上下文定义的代码出入太大，难以理解，楼主的文章写的很好，希望不要被这些细节给毁了，希望能重新整理测试下代码。感谢。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="533cd66d86c0305904038d6a" reply_to_id="" id="533cd66d86c0305904038d6a">
  <div class="author_content">
    <a href="http://cnodejs.org/user/shanelau" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3140898" title="shanelau"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/shanelau">shanelau</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#533cd66d86c0305904038d6a">39楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-shanelau">
    <div class="markdown-text"><p>能整理成一个文档发出来吗？ 看网页  有点麻烦</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5348a12f3a4cdf5c7b015658" reply_to_id="" id="5348a12f3a4cdf5c7b015658">
  <div class="author_content">
    <a href="http://cnodejs.org/user/appellcode" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3927354" title="appellcode"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/appellcode">appellcode</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5348a12f3a4cdf5c7b015658">40楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-appellcode">
    <div class="markdown-text"><p>仅仅只是一断代码 =&gt; 仅仅只是一段代码 ？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="534f33f71969a7b22a24d482" reply_to_id="" id="534f33f71969a7b22a24d482">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wensonsmith" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/b68f9fb110894a8d3899460dfd977ec9" title="wensonsmith"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wensonsmith">wensonsmith</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#534f33f71969a7b22a24d482">41楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wensonsmith">
    <div class="markdown-text"><p>在 2.1 章节里面, 使用如下的示例代码，</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonSchema</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'krouky'</span><span class="pun">,</span><span class="pln">type</span><span class="pun">:</span><span class="str">'前端工程师'</span><span class="pun">});</span></code></pre><p>是不是应该改成</p>
<pre class="prettyprint"><code><span class="kwd">var</span><span class="pln"> krouky </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'krouky'</span><span class="pun">,</span><span class="pln">type</span><span class="pun">:</span><span class="str">'前端工程师'</span><span class="pun">});</span></code></pre></div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="536d0dc029b620e05701d97f" reply_to_id="" id="536d0dc029b620e05701d97f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/2eron" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3272874" title="2eron"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/2eron">2eron</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#536d0dc029b620e05701d97f">42楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-2eron">
    <div class="markdown-text"><p>关于数据库连接有个问题，如果数据库开启了权限控制，那么就需要先登录Admin，请问怎样可以直接连接非admin数据库呢？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5385d808a087f45620e51c99" reply_to_id="" id="5385d808a087f45620e51c99">
  <div class="author_content">
    <a href="http://cnodejs.org/user/struCoder" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6498477" title="struCoder"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/struCoder">struCoder</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5385d808a087f45620e51c99">43楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-struCoder">
    <div class="markdown-text"><p>mark学习!</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5386ea48c3ee0b58201c7399" reply_to_id="" id="5386ea48c3ee0b58201c7399">
  <div class="author_content">
    <a href="http://cnodejs.org/user/keinwang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/d10fbc3e88bd69de7b5e46d80fac3c90" title="keinwang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/keinwang">keinwang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5386ea48c3ee0b58201c7399">44楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-keinwang">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5386f011c3ee0b58201d9da5" reply_to_id="5386ea48c3ee0b58201c7399" id="5386f011c3ee0b58201d9da5">
  <div class="author_content">
    <a href="http://cnodejs.org/user/micoor" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/7707918" title="micoor"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/micoor">micoor</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5386f011c3ee0b58201d9da5">45楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-micoor">
    <div class="markdown-text"><p>要不要来我们工作圈的Node.js实战圈子交流一下？非常欢迎您来做客交流分享。手机在应用市场搜索“工作圈”安装注册，或去工作圈网站了解（<a href="http://www.gongzuoquan.com/" target="_blank">www.gongzuoquan.com</a>），您注册好后，告诉我注册邮箱或手机号，我拉您进圈子。嘿嘿。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5386f034a087f45620164503" reply_to_id="5385d808a087f45620e51c99" id="5386f034a087f45620164503">
  <div class="author_content">
    <a href="http://cnodejs.org/user/micoor" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/7707918" title="micoor"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/micoor">micoor</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5386f034a087f45620164503">46楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-micoor">
    <div class="markdown-text"><p>要不要来我们工作圈的Node.js实战圈子交流一下？非常欢迎您来做客交流分享。手机在应用市场搜索“工作圈”安装注册，或去工作圈网站了解（<a href="http://www.gongzuoquan.com/" target="_blank">www.gongzuoquan.com</a>），您注册好后，告诉我注册邮箱或手机号，我拉您进圈子。嘻嘻。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="53abeb5ca087f456209242fe" reply_to_id="536d0dc029b620e05701d97f" id="53abeb5ca087f456209242fe">
  <div class="author_content">
    <a href="http://cnodejs.org/user/udbmnm" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1905823" title="udbmnm"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/udbmnm">udbmnm</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#53abeb5ca087f456209242fe">47楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-udbmnm">
    <div class="markdown-text"><p>我也很想知道，你链接成功了吗？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="53e17cac111cfedf0bb060ac" reply_to_id="536d0dc029b620e05701d97f" id="53e17cac111cfedf0bb060ac">
  <div class="author_content">
    <a href="http://cnodejs.org/user/perny" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3123626" title="perny"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/perny">perny</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#53e17cac111cfedf0bb060ac">48楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-perny">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/2eron" target="_blank">@2eron</a> 我最近页遇到了这个问题，你解决了么？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="53e17cd0111cfedf0bb06759" reply_to_id="536d0dc029b620e05701d97f" id="53e17cd0111cfedf0bb06759">
  <div class="author_content">
    <a href="http://cnodejs.org/user/perny" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3123626" title="perny"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/perny">perny</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#53e17cd0111cfedf0bb06759">49楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-perny">
    <div class="markdown-text"><p>这个问题你解决了么？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="54114965a0c965223bd20d51" reply_to_id="" id="54114965a0c965223bd20d51">
  <div class="author_content">
    <a href="http://cnodejs.org/user/hc2014" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/7654157" title="hc2014"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/hc2014">hc2014</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#54114965a0c965223bd20d51">50楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-hc2014">
    <div class="markdown-text"><p>楼主,想请问一下,假如我已经有的数据库的collecion 有没有什么方法？我查看了下文档没有找到相关的说明</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="54114fe9351649283bd8287b" reply_to_id="" id="54114fe9351649283bd8287b">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ASCII26" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5102623" title="ASCII26"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ASCII26">ASCII26</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#54114fe9351649283bd8287b">51楼•3 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ASCII26">
    <div class="markdown-text"><p>cnode竟然没有关注此文章的功能。。。只能评论一下了。mark!</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="546cb5b4d1ff63cc7fe27c08" reply_to_id="52e7157c78990b041163dbe0" id="546cb5b4d1ff63cc7fe27c08">
  <div class="author_content">
    <a href="http://cnodejs.org/user/xuyuan923" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3841213" title="xuyuan923"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/xuyuan923">xuyuan923</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#546cb5b4d1ff63cc7fe27c08">52楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-xuyuan923">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/jay61439476" target="_blank">@jay61439476</a> 我今天也遇到了和你一样的错误，请问你解决了吗？怎么解决的？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="546dbd2d9d256abe2084ac10" reply_to_id="" id="546dbd2d9d256abe2084ac10">
  <div class="author_content">
    <a href="http://cnodejs.org/user/JerroldLee" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5645510" title="JerroldLee"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/JerroldLee">JerroldLee</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#546dbd2d9d256abe2084ac10">53楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-JerroldLee">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="547dbd100ae47dec03aa2a19" reply_to_id="" id="547dbd100ae47dec03aa2a19">
  <div class="author_content">
    <a href="http://cnodejs.org/user/borisyu" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3347703" title="borisyu"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/borisyu">borisyu</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#547dbd100ae47dec03aa2a19">54楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-borisyu">
    <div class="markdown-text"><p>在定义 Schema 的时候，title: String 和 title: {type: String} 有什么区别？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="547e66cc0ae47dec03aa2a32" reply_to_id="" id="547e66cc0ae47dec03aa2a32">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jeremy16601" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/2002979" title="jeremy16601"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jeremy16601">jeremy16601</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#547e66cc0ae47dec03aa2a32">55楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jeremy16601">
    <div class="markdown-text"><p>干货啊，谢谢分享！！！</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="547e6d3b0ae47dec03aa2a3b" reply_to_id="" id="547e6d3b0ae47dec03aa2a3b">
  <div class="author_content">
    <a href="http://cnodejs.org/user/yunfei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/325867574aebe24b5bc4dbf66b7df8d0" title="yunfei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/yunfei">yunfei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#547e6d3b0ae47dec03aa2a3b">56楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-yunfei">
    <div class="markdown-text"><p>楼主好吊！！！！！！！！！！！</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5559527b7cabb7b45ee6be3c" reply_to_id="" id="5559527b7cabb7b45ee6be3c">
  <div class="author_content">
    <a href="http://cnodejs.org/user/CommanderXL" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/9695264" title="CommanderXL"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/CommanderXL">CommanderXL</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5559527b7cabb7b45ee6be3c">57楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-CommanderXL">
    <div class="markdown-text"><p>其他的专题在哪呢?</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5559c30115447cf109091055" reply_to_id="" id="5559c30115447cf109091055">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jasonworg" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3283067" title="jasonworg"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jasonworg">jasonworg</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5559c30115447cf109091055">58楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jasonworg">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5559c33415447cf109091057" reply_to_id="" id="5559c33415447cf109091057">
  <div class="author_content">
    <a href="http://cnodejs.org/user/cjwanga" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/12494877" title="cjwanga"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/cjwanga">cjwanga</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5559c33415447cf109091057">59楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-cjwanga">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/jasonworg" target="_blank">@jasonworg</a> mark.</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5559c6a415447cf10909105e" reply_to_id="" id="5559c6a415447cf10909105e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/liygheart" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6915570" title="liygheart"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/liygheart">liygheart</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5559c6a415447cf10909105e">60楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-liygheart">
    <div class="markdown-text"><p>客户端好像没法收藏，先回复mark一下
自豪地采用 <a href="https://github.com/lanceli/cnodejs-ionic" target="_blank">CNodeJS ionic</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="55f0eccf9ae0f45035ae49b1" reply_to_id="" id="55f0eccf9ae0f45035ae49b1">
  <div class="author_content">
    <a href="http://cnodejs.org/user/1340641314" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/8424643" title="1340641314"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/1340641314">1340641314</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#55f0eccf9ae0f45035ae49b1">61楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-1340641314">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="55ffc586272b724e5efefb74" reply_to_id="" id="55ffc586272b724e5efefb74">
  <div class="author_content">
    <a href="http://cnodejs.org/user/BangKk" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13979818" title="BangKk"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/BangKk">BangKk</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#55ffc586272b724e5efefb74">62楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-BangKk">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/a272121742" target="_blank">@a272121742</a>  请问2.1中的原理是什么？ 怎么把查到的数据保存在cb中方的persons里面的？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5603d0f5148959375f34feb4" reply_to_id="" id="5603d0f5148959375f34feb4">
  <div class="author_content">
    <a href="http://cnodejs.org/user/zhangjx" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1531780" title="zhangjx"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/zhangjx">zhangjx</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5603d0f5148959375f34feb4">63楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-zhangjx">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5624d5ca573d7ba30ab1507e" reply_to_id="" id="5624d5ca573d7ba30ab1507e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/x-web" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/12498412" title="x-web"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/x-web">x-web</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5624d5ca573d7ba30ab1507e">64楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-x-web">
    <div class="markdown-text"><p>mark，干货啊，希望再讲讲MapReduce。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5624f63efedab0270ba0b6d2" reply_to_id="" id="5624f63efedab0270ba0b6d2">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wewea" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/16569391" title="wewea"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wewea">wewea</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5624f63efedab0270ba0b6d2">65楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wewea">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="562f2244ff488da5449343bb" reply_to_id="" id="562f2244ff488da5449343bb">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ovenchang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/454246" title="ovenchang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ovenchang">ovenchang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#562f2244ff488da5449343bb">66楼•2 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ovenchang">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5656aa94b1e04fda51bcdf2e" reply_to_id="" id="5656aa94b1e04fda51bcdf2e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/aisin" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/2437475" title="aisin"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/aisin">aisin</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5656aa94b1e04fda51bcdf2e">67楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-aisin">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5657c33bb1e04fda51bcdf77" reply_to_id="" id="5657c33bb1e04fda51bcdf77">
  <div class="author_content">
    <a href="http://cnodejs.org/user/Einsy" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/2882139" title="Einsy"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/Einsy">Einsy</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5657c33bb1e04fda51bcdf77">68楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-Einsy">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="565916533cda7a91276ff75f" reply_to_id="" id="565916533cda7a91276ff75f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/SeongBrave" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/10784393" title="SeongBrave"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/SeongBrave">SeongBrave</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#565916533cda7a91276ff75f">69楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-SeongBrave">
    <div class="markdown-text"><p>不错的文章</p>
<p>来自酷炫的 <a href="https://github.com/TakWolf/CNode-Material-Design" target="_blank">CNodeMD</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="565945db3cda7a91276ff768" reply_to_id="" id="565945db3cda7a91276ff768">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wangshaochun" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5078677" title="wangshaochun"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wangshaochun">wangshaochun</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#565945db3cda7a91276ff768">70楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wangshaochun">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="565d9ca0c4fa25cb27cc3cd7" reply_to_id="" id="565d9ca0c4fa25cb27cc3cd7">
  <div class="author_content">
    <a href="http://cnodejs.org/user/chenpeng1102" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5126241" title="chenpeng1102"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/chenpeng1102">chenpeng1102</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#565d9ca0c4fa25cb27cc3cd7">71楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-chenpeng1102">
    <div class="markdown-text"><p>这才是干货</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="565e3c8fc4fa25cb27cc3cef" reply_to_id="" id="565e3c8fc4fa25cb27cc3cef">
  <div class="author_content">
    <a href="http://cnodejs.org/user/PolarisSky" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/8310521" title="PolarisSky"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/PolarisSky">PolarisSky</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#565e3c8fc4fa25cb27cc3cef">72楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-PolarisSky">
    <div class="markdown-text"><p>mark
自豪地采用 <a href="https://github.com/lanceli/cnodejs-ionic" target="_blank">CNodeJS ionic</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="565e6051d0bc14ae27939a8c" reply_to_id="" id="565e6051d0bc14ae27939a8c">
  <div class="author_content">
    <a href="http://cnodejs.org/user/echoloyuk" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/4003335" title="echoloyuk"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/echoloyuk">echoloyuk</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#565e6051d0bc14ae27939a8c">73楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-echoloyuk">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="566153d0966aefd958de7d78" reply_to_id="" id="566153d0966aefd958de7d78">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wizali" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5663201" title="wizali"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wizali">wizali</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#566153d0966aefd958de7d78">74楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wizali">
    <div class="markdown-text"><p>文是好文，就是错误有点多。。。呵呵</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="567bcfdb10b0249d07105da8" reply_to_id="" id="567bcfdb10b0249d07105da8">
  <div class="author_content">
    <a href="http://cnodejs.org/user/chenjsh36" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/11667095" title="chenjsh36"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/chenjsh36">chenjsh36</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#567bcfdb10b0249d07105da8">75楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-chenjsh36">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5684ae028b1f63cb401b729e" reply_to_id="" id="5684ae028b1f63cb401b729e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/sunzhiguang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/7146733" title="sunzhiguang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/sunzhiguang">sunzhiguang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5684ae028b1f63cb401b729e">76楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-sunzhiguang">
    <div class="markdown-text"><p>MARK</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="569473a804a9c540665c46f3" reply_to_id="" id="569473a804a9c540665c46f3">
  <div class="author_content">
    <a href="http://cnodejs.org/user/cjz9032" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/11435814" title="cjz9032"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/cjz9032">cjz9032</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#569473a804a9c540665c46f3">77楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-cjz9032">
    <div class="markdown-text"><p>数组也要以array.set才有约束.还有mixed
还有date 暂时想到这3个要markmodified</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="56a5b41bcf60b1b94bab3449" reply_to_id="504b4a05e2b8451577010ccb" id="56a5b41bcf60b1b94bab3449">
  <div class="author_content">
    <a href="http://cnodejs.org/user/gitovers" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/9820592" title="gitovers"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/gitovers">gitovers</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#56a5b41bcf60b1b94bab3449">78楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          " title="喜欢"></i>
        <span class="up-count">
          1
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-gitovers">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/a272121742" target="_blank">@a272121742</a> <code>#</code>号后面空一个空格,就会显示大标题了.</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="56a5b74ecf60b1b94bab344e" reply_to_id="" id="56a5b74ecf60b1b94bab344e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/bringdy" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/11283766" title="bringdy"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/bringdy">bringdy</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#56a5b74ecf60b1b94bab344e">79楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-bringdy">
    <div class="markdown-text"><p>mark 学习中</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="56d289daa3e318b766ffb9cb" reply_to_id="" id="56d289daa3e318b766ffb9cb">
  <div class="author_content">
    <a href="http://cnodejs.org/user/duguhaotian" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3174621" title="duguhaotian"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/duguhaotian">duguhaotian</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#56d289daa3e318b766ffb9cb">80楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-duguhaotian">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="56d664e06f57517277f46553" reply_to_id="" id="56d664e06f57517277f46553">
  <div class="author_content">
    <a href="http://cnodejs.org/user/AlfredYan" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/14922683" title="AlfredYan"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/AlfredYan">AlfredYan</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#56d664e06f57517277f46553">81楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-AlfredYan">
    <div class="markdown-text"><p>Mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="574daad985dc0f593013643f" reply_to_id="" id="574daad985dc0f593013643f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/yinqiao" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5876802" title="yinqiao"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/yinqiao">yinqiao</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#574daad985dc0f593013643f">82楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-yinqiao">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="574db8116e66e5393082765a" reply_to_id="" id="574db8116e66e5393082765a">
  <div class="author_content">
    <a href="http://cnodejs.org/user/TongeJie" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13251600" title="TongeJie"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/TongeJie">TongeJie</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#574db8116e66e5393082765a">83楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-TongeJie">
    <div class="markdown-text"><p>mark
From <a href="https://github.com/soliury/noder-react-native" target="_blank">Noder</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="576275a7fa83165906ace3e3" reply_to_id="" id="576275a7fa83165906ace3e3">
  <div class="author_content">
    <a href="http://cnodejs.org/user/hillwah" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/2394352" title="hillwah"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/hillwah">hillwah</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#576275a7fa83165906ace3e3">84楼•1 年前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-hillwah">
    <div class="markdown-text"><p>有没有更多相关资料？谢谢你的大作。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="578ca2fa43fb9f04148cfc1e" reply_to_id="566153d0966aefd958de7d78" id="578ca2fa43fb9f04148cfc1e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/amor520" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/14037268" title="amor520"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/amor520">amor520</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#578ca2fa43fb9f04148cfc1e">85楼•10 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-amor520">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/wizali" target="_blank">@wizali</a> 呵呵</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="578d0b1f6d3f2b2014113f64" reply_to_id="" id="578d0b1f6d3f2b2014113f64">
  <div class="author_content">
    <a href="http://cnodejs.org/user/13241491189" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/14305704" title="13241491189"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/13241491189">13241491189</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#578d0b1f6d3f2b2014113f64">86楼•10 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-13241491189">
    <div class="markdown-text"><p>回味经典</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5799af5b4cddcb432614689a" reply_to_id="" id="5799af5b4cddcb432614689a">
  <div class="author_content">
    <a href="http://cnodejs.org/user/nanfei9330" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/5087738" title="nanfei9330"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/nanfei9330">nanfei9330</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5799af5b4cddcb432614689a">87楼•9 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-nanfei9330">
    <div class="markdown-text"><p>db.model(‘Person’   这里的Person有什么用呢？好像这个改什么结果都一样的？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="579f058dda05b9e92af325e3" reply_to_id="" id="579f058dda05b9e92af325e3">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wssss" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/12889262" title="wssss"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wssss">wssss</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#579f058dda05b9e92af325e3">88楼•9 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wssss">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57a8891d4653749872ec6ed9" reply_to_id="" id="57a8891d4653749872ec6ed9">
  <div class="author_content">
    <a href="http://cnodejs.org/user/foryuki" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/8649233" title="foryuki"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/foryuki">foryuki</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57a8891d4653749872ec6ed9">89楼•9 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-foryuki">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57abee8e476898b472247dee" reply_to_id="" id="57abee8e476898b472247dee">
  <div class="author_content">
    <a href="http://cnodejs.org/user/MyNodeJs" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6858092" title="MyNodeJs"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/MyNodeJs">MyNodeJs</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57abee8e476898b472247dee">90楼•9 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-MyNodeJs">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57bb9603b32043f532d40e36" reply_to_id="" id="57bb9603b32043f532d40e36">
  <div class="author_content">
    <a href="http://cnodejs.org/user/NextZeus" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/10203487" title="NextZeus"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/NextZeus">NextZeus</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57bb9603b32043f532d40e36">91楼•8 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-NextZeus">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57bd21c06b04813133ba9118" reply_to_id="" id="57bd21c06b04813133ba9118">
  <div class="author_content">
    <a href="http://cnodejs.org/user/LVPlum" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/18657438" title="LVPlum"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/LVPlum">LVPlum</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57bd21c06b04813133ba9118">92楼•8 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-LVPlum">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/a272121742" target="_blank">@a272121742</a>
From <a href="https://github.com/soliury/noder-react-native" target="_blank">Noder</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57bd2633b32043f532d40edb" reply_to_id="51bef23e52997eac1e00c186" id="57bd2633b32043f532d40edb">
  <div class="author_content">
    <a href="http://cnodejs.org/user/LVPlum" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/18657438" title="LVPlum"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/LVPlum">LVPlum</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57bd2633b32043f532d40edb">93楼•8 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-LVPlum">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/a272121742" target="_blank">@a272121742</a> 菜鸟拜帖，弱弱的问一下，可视化工具用的是什么~</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57c7e877a843659126f98bc6" reply_to_id="" id="57c7e877a843659126f98bc6">
  <div class="author_content">
    <a href="http://cnodejs.org/user/598220654" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/15324717" title="598220654"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/598220654">598220654</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57c7e877a843659126f98bc6">94楼•8 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-598220654">
    <div class="markdown-text"><p>原文章在哪里,他说有些第一章详细介绍,为什么没有原文章地址?</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57e0f6d9c4ae8ff239776dbc" reply_to_id="57bd2633b32043f532d40edb" id="57e0f6d9c4ae8ff239776dbc">
  <div class="author_content">
    <a href="http://cnodejs.org/user/weierbufan" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/6757408" title="weierbufan"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/weierbufan">weierbufan</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57e0f6d9c4ae8ff239776dbc">95楼•8 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-weierbufan">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/LVPlum" target="_blank">@LVPlum</a> 使用<strong>mongobooster</strong></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57e62a21a598b6e4043efc70" reply_to_id="" id="57e62a21a598b6e4043efc70">
  <div class="author_content">
    <a href="http://cnodejs.org/user/leo493852107" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/9987499" title="leo493852107"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/leo493852107">leo493852107</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57e62a21a598b6e4043efc70">96楼•7 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-leo493852107">
    <div class="markdown-text"><p>拜读收藏</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="57e64482c82da6fd04be793e" reply_to_id="" id="57e64482c82da6fd04be793e">
  <div class="author_content">
    <a href="http://cnodejs.org/user/zhaoxixiong" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/19833664" title="zhaoxixiong"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/zhaoxixiong">zhaoxixiong</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#57e64482c82da6fd04be793e">97楼•7 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-zhaoxixiong">
    <div class="markdown-text"><p>真的是干货，这篇文章我看了好多遍，只是想用Express.js做一个简单的博客系统，如果要做成像我现在网站（<a href="http://yunkus.com/" target="_blank">http://yunkus.com</a>）这样的可以实现吗？如果可以我需要注意哪些可能存在的问题，比如：数据库的结构（到现在还让我很头疼），例如，一个用户发表的文章，评论，怎么联系起来，这样的疑问真的不少。有相关的文章推荐吗大伙们？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5813194acf18d0333412d28f" reply_to_id="57e64482c82da6fd04be793e" id="5813194acf18d0333412d28f">
  <div class="author_content">
    <a href="http://cnodejs.org/user/fangker" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/16358646" title="fangker"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/fangker">fangker</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5813194acf18d0333412d28f">98楼•6 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-fangker">
    <div class="markdown-text"><p><a href="http://cnodejs.org/user/zhaoxixiong" target="_blank">@zhaoxixiong</a> 可以的，可以加我q1711126123	最近我也在着手折腾。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5814a1b7b37ee8fb33978921" reply_to_id="" id="5814a1b7b37ee8fb33978921">
  <div class="author_content">
    <a href="http://cnodejs.org/user/dlutwuwei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/3362483" title="dlutwuwei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/dlutwuwei">dlutwuwei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5814a1b7b37ee8fb33978921">99楼•6 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-dlutwuwei">
    <div class="markdown-text"><p>&lt;div&gt;&lt;p&gt;&lt;!-- react-text: 14912 --&gt;test reply&lt;!-- /react-text --&gt;&lt;/p&gt;&lt;/div&gt;</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5836d6f9ba57ffba06c24944" reply_to_id="" id="5836d6f9ba57ffba06c24944">
  <div class="author_content">
    <a href="http://cnodejs.org/user/mikeliyanwei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/22575496" title="mikeliyanwei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/mikeliyanwei">mikeliyanwei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5836d6f9ba57ffba06c24944">100楼•5 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-mikeliyanwei">
    <div class="markdown-text"><p>学习中</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="583aa0ccba57ffba06c24a22" reply_to_id="" id="583aa0ccba57ffba06c24a22">
  <div class="author_content">
    <a href="http://cnodejs.org/user/mewtwo-cn" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/7699570" title="mewtwo-cn"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/mewtwo-cn">mewtwo-cn</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#583aa0ccba57ffba06c24a22">101楼•5 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-mewtwo-cn">
    <div class="markdown-text"><p>7.我们甚至可以为此Schema创建方法</p>
<pre class="prettyprint"><code><span class="com">//为Schema模型追加speak方法</span><span class="pln">
</span><span class="typ">PersonSchema</span><span class="pun">.</span><span class="pln">methos</span><span class="pun">.</span><span class="pln">speak </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'我的名字叫'</span><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'Person'</span><span class="pun">,</span><span class="typ">PersonSchema</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> personEntity </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PersonModel</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">'Krouky'</span><span class="pun">});</span><span class="pln">
personEntity</span><span class="pun">.</span><span class="pln">speak</span><span class="pun">();</span><span class="com">//我的名字叫Krouky</span></code></pre><p>字打错了，应该是：
PersonSchema.methods.speak = function(){
console.log(‘我的名字叫’+<a href="http://this.name/" target="_blank">this.name</a>);
}</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="583e8685254727447987caaf" reply_to_id="" id="583e8685254727447987caaf">
  <div class="author_content">
    <a href="http://cnodejs.org/user/ajaxQWER" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/16046545" title="ajaxQWER"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/ajaxQWER">ajaxQWER</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#583e8685254727447987caaf">102楼•5 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-ajaxQWER">
    <div class="markdown-text"><p>经测试，在new数据库模型的时候，即1.2-5  var PersonModel = db.model(‘Person’,PersonSchema);的时候，很多人问为什么有个people库存在，是因为mongoose把person转换成了复数people作为数据库模型存储起来了，不信你换成animal，company等名词单数，会给你转换成名词复数作为数据库模型存储。（大概就是这个意思，语言不是太干练）
来自于: <a href="http://mongoosejs.com/docs/models.html" target="_blank">Models</a>
<strong>The first argument is the singular name of the collection your model is for. Mongoose automatically looks for the plural version of your model name.</strong>
Thus, for the example above, the model Tank is for the tanks collection in the database. The .model() function makes a copy of schema. Make sure that you’ve added everything you want to schema before calling .model()!</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="5885a6dd1dc8ff8739cbc5db" reply_to_id="" id="5885a6dd1dc8ff8739cbc5db">
  <div class="author_content">
    <a href="http://cnodejs.org/user/buyixiaojiang" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13343827" title="buyixiaojiang"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/buyixiaojiang">buyixiaojiang</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#5885a6dd1dc8ff8739cbc5db">103楼•3 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-buyixiaojiang">
    <div class="markdown-text"><p>谢谢，以前不怎么理解的东西，现在能系统化的了解了一下。原文中可能有几个小错误。。我看到有的评论已经指出来了。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58aebd135b904b25651b388d" reply_to_id="" id="58aebd135b904b25651b388d">
  <div class="author_content">
    <a href="http://cnodejs.org/user/461534898" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/19420589" title="461534898"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/461534898">461534898</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58aebd135b904b25651b388d">104楼•2 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-461534898">
    <div class="markdown-text"><p>mark一下</p>
<p><a href="https://github.com/TakWolf/CNode-Material-Design" target="_blank">lzq920</a>欢天喜地的发表了这一条评论。</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58b7bfc0ea21217a4486cf01" reply_to_id="" id="58b7bfc0ea21217a4486cf01">
  <div class="author_content">
    <a href="http://cnodejs.org/user/bonzstars" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/22025787" title="bonzstars"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/bonzstars">bonzstars</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58b7bfc0ea21217a4486cf01">105楼•2 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-bonzstars">
    <div class="markdown-text"><p>好东西， 正在学习Mongoose</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58b7d29be418a986315f3ab6" reply_to_id="" id="58b7d29be418a986315f3ab6">
  <div class="author_content">
    <a href="http://cnodejs.org/user/lastIndexOf" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13101975" title="lastIndexOf"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/lastIndexOf">lastIndexOf</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58b7d29be418a986315f3ab6">106楼•2 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-lastIndexOf">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58de2082b3e60b982d089daf" reply_to_id="" id="58de2082b3e60b982d089daf">
  <div class="author_content">
    <a href="http://cnodejs.org/user/Chalin-Shi" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13328160" title="Chalin-Shi"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/Chalin-Shi">Chalin-Shi</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58de2082b3e60b982d089daf">107楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-Chalin-Shi">
    <div class="markdown-text"><h2>Mark</h2>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58de24e2b3e60b982d089db3" reply_to_id="" id="58de24e2b3e60b982d089db3">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wuyinlei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/14150120" title="wuyinlei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wuyinlei">wuyinlei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58de24e2b3e60b982d089db3">108楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wuyinlei">
    <div class="markdown-text"><p>120楼</p>
<p>来自酷炫的 <a href="https://github.com/TakWolf/CNode-Material-Design" target="_blank">CNodeMD</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58de258e03d476b42d34c937" reply_to_id="" id="58de258e03d476b42d34c937">
  <div class="author_content">
    <a href="http://cnodejs.org/user/wuyinlei" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/14150120" title="wuyinlei"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/wuyinlei">wuyinlei</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58de258e03d476b42d34c937">109楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-wuyinlei">
    <div class="markdown-text"><p>你好厉害</p>
<p>来自酷炫的 <a href="https://github.com/TakWolf/CNode-Material-Design" target="_blank">CNodeMD</a></p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58e5ee7ac669764920c00a57" reply_to_id="" id="58e5ee7ac669764920c00a57">
  <div class="author_content">
    <a href="http://cnodejs.org/user/Chalin-Shi" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/13328160" title="Chalin-Shi"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/Chalin-Shi">Chalin-Shi</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58e5ee7ac669764920c00a57">110楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-Chalin-Shi">
    <div class="markdown-text"><p>@作者</p>
<pre class="prettyprint language-js"><code><span class="kwd">const</span><span class="pln"> mongoose </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="str">'../db/mongo'</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="typ">Schema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="typ">Schema</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="typ">ObjectId</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">.</span><span class="typ">Types</span><span class="pun">.</span><span class="typ">ObjectId</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="typ">UserSchema</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Schema</span><span class="pun">({</span><span class="pln">
  uid</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> </span><span class="typ">ObjectId</span><span class="pln"> </span><span class="pun">},</span><span class="pln">
  email</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">},</span><span class="pln">
  age</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Number</span><span class="pln"> </span><span class="pun">},</span><span class="pln">
  password</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">},</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="typ">User</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mongoose</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="str">'User'</span><span class="pun">,</span><span class="pln"> </span><span class="typ">UserSchema</span><span class="pun">)</span><span class="pln">
module</span><span class="pun">.</span><span class="pln">exports </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span></code></pre><p>为什么save后，还是有_id而没有uid呢？</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58e5fb19c669764920c00a5c" reply_to_id="" id="58e5fb19c669764920c00a5c">
  <div class="author_content">
    <a href="http://cnodejs.org/user/jiangzhuo" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/1468716" title="jiangzhuo"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/jiangzhuo">jiangzhuo</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58e5fb19c669764920c00a5c">111楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-jiangzhuo">
    <div class="markdown-text"><p>这帖子厉害了 16W的阅读</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58e72c0d1dfcad3105ce91c5" reply_to_id="" id="58e72c0d1dfcad3105ce91c5">
  <div class="author_content">
    <a href="http://cnodejs.org/user/sysoft" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/03ed6a3fd873bdaa3ae79b61a0b452d5" title="sysoft"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/sysoft">sysoft</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58e72c0d1dfcad3105ce91c5">112楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-sysoft">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58e72c681dfcad3105ce91c7" reply_to_id="" id="58e72c681dfcad3105ce91c7">
  <div class="author_content">
    <a href="http://cnodejs.org/user/sc-yuns" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/10323405" title="sc-yuns"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/sc-yuns">sc-yuns</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58e72c681dfcad3105ce91c7">113楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-sc-yuns">
    <div class="markdown-text"><p>mark</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>
<div class="cell reply_area reply_item
  " reply_id="58eb524462b12d1b052e7a68" reply_to_id="" id="58eb524462b12d1b052e7a68">
  <div class="author_content">
    <a href="http://cnodejs.org/user/frank320" class="user_avatar">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/20333833" title="frank320"></a>

    <div class="user_info">
      <a class="dark reply_author" href="http://cnodejs.org/user/frank320">frank320</a>
      <a class="reply_time" href="http://cnodejs.org/topic/504b4924e2b84515770103dd#58eb524462b12d1b052e7a68">114楼•1 个月前</a>
      
    </div>
    <div class="user_action">
      <span>
        <i class="fa up_btn
          fa-thumbs-o-up
          invisible" title="喜欢"></i>
        <span class="up-count">
          
        </span>
      </span>
      
      <span>
        
      </span>
    </div>
  </div>
  <div class="reply_content from-frank320">
    <div class="markdown-text"><p>五年前的啊  现在api都更新了不少了吧</p>
</div>
  </div>
  <div class="clearfix">
    <div class="reply2_area">
      
    </div>
  </div>
</div>

  </div>
  
  
</div>

<div class="replies_history" style="display: none;">
  <div class="inner_content"></div>
  <div class="anchor"></div>
</div>

<!-- 预览模态对话框 -->
<div class="modal fade" id="preview-modal">
  <div class="modal-body" style="max-height: initial;">
    <img src="http://cnodejs.org/topic/504b4924e2b84515770103dd" alt="点击内容或者外部自动关闭图片预览" id="preview-image">
  </div>
</div>




<script type="text/javascript">
  (function(){
    var timer = null; //对话框延时定时器
    // 初始化 $('.replies_history')
    var $repliesHistory = $('.replies_history');
    var $repliesHistoryContent = $repliesHistory.find('.inner_content');
    $repliesHistory.hide();
    // END
    // 鼠标移入对话框清除隐藏定时器；移出时隐藏对话框
    $repliesHistory.on('mouseenter', function(){
      clearTimeout(timer);
    }).on('mouseleave', function(){
      $repliesHistory.fadeOut('fast');
    });
    // 显示被 at 用户的本页评论
    if ($('.reply2_item').length === 0) {
      // 只在流式评论布局中使用

      $('#content').on('mouseenter', '.reply_content a', function (e) {
        clearTimeout(timer);
        var $this = $(this);
        if ($this.text()[0] === '@') {
          var thisText = $this.text().trim();
          var loginname = thisText.slice(1);
          var offset = $this.offset();
          var width = $this.width();
          var mainOffset = $('#main').offset();
          $repliesHistory.css('left', offset.left-mainOffset.left+width+10); // magic number
          $repliesHistory.css('top', offset.top-mainOffset.top-10); // magic number
          $repliesHistory.css({
            'z-index': 1,
          });
          $repliesHistoryContent.empty();
          var chats = [];
          var replyToId = $this.closest('.reply_item').attr('reply_to_id');
          while (replyToId) {
            var $replyItem = $('.reply_item[reply_id=' + replyToId + ']');
            var replyContent = $replyItem.find('.reply_content').text().trim();
            if (replyContent.length > 0) {
              chats.push([
                $($replyItem.find('.user_avatar').html()).attr({
                  height: '30px',
                  width: '30px',
                }), // avatar
                (replyContent.length>300?replyContent.substr(0,300)+'...':replyContent), // reply content
                '<a href="#'+replyToId+'" class="scroll_to_original" title="查看原文">↑</a>'
              ]);
            }
            replyToId = $replyItem.attr('reply_to_id');
          }
          if(chats.length > 0) {
            chats.reverse();

            $repliesHistoryContent.append('<div class="title">查看对话</div>');
            chats.forEach(function (pair, idx) {
              var $chat = $repliesHistoryContent.append('<div class="item"></div>');
              $chat.append(pair[0]); // 头像
              $chat.append($('<span>').text(pair[1])); // 内容
              $chat.append(pair[2]); // 查看原文 anchor
            });
            $repliesHistory.fadeIn('fast');
          }else{
            $repliesHistory.hide();
          }
        }
      }).on('mouseleave', '.reply_content a', function (e) {
        timer = setTimeout(function(){
          $repliesHistory.fadeOut('fast');
        }, 500);
      });
    }
    // END 显示被 at 用户的本页评论
  })();

  // 点赞
  $('.up_btn').click(function (e) {
    var $this = $(this);
    var replyId = $this.closest('.reply_area').attr('reply_id');
    $.ajax({
      url: '/reply/' + replyId + '/up',
      method: 'POST',
    }).done(function (data) {
      if (data.success) {
        $this.removeClass('invisible');
        var currentCount = Number($this.next('.up-count').text().trim()) || 0;
        if (data.action === 'up') {
          $this.next('.up-count').text(currentCount + 1);
          $this.addClass('uped');
        } else {
          if (data.action === 'down') {
            $this.next('.up-count').text(currentCount - 1);
            $this.removeClass('uped');
          }
        }
      } else {
        alert(data.message);
      }
    }).fail(function (xhr) {
      if (xhr.status === 403) {
        alert('请先登录，登陆后即可点赞。');
      }
    });
  });
  // END 点赞
  // 图片预览
  (function(){
    var $previewModal = $('#preview-modal');
    var $previewImage = $('#preview-image');
    var $body = $('body'); // cache

    $(document).on('click', '.markdown-text img', function(e) {
      var $img = $(this);
      // 图片被a标签包裹时，不显示弹层
      if ($img.parent('a').length > 0) {
        return;
      }
      showModal($img.attr('src'));
    });

    $previewModal.on('click', hideModal);

    $previewModal.on('hidden.bs.modal', function() {
      // 在预览框消失之后恢复 body 的滚动能力
      $body.css('overflow-y', 'scroll');
    })

    $previewModal.on('shown.bs.modal', function() {
      // 修复上次滚动留下的痕迹,可能会导致短暂的闪烁，不过可以接受
      // TODO: to be promote
      $previewModal.scrollTop(0);
    })

    function showModal(src) {
      $previewImage.attr('src', src);
      $previewModal.modal('show');
      // 禁止 body 滚动
      $body.css('overflow-y', 'hidden');
    }

    function hideModal() {
      $previewModal.modal('hide');
    }

  })()
  // END 图片预览
</script>

</div>
<div id="backtotop" style="display: block; top: 382px; right: 0px;">回到顶部</div>
<div id="footer">
  <div id="footer_main">
    <div class="links">
      <a class="dark" href="http://cnodejs.org/rss">RSS</a>
      |
      <a class="dark" href="https://github.com/cnodejs/nodeclub/">源码地址</a>
    </div>

    <div class="col_fade">

  <p>CNode 社区为国内最专业的 Node.js 开源技术社区，致力于 Node.js 的技术研究。</p>
  <p>服务器赞助商为
    <a href="http://www.ucloud.cn/?utm_source=zanzhu&amp;utm_campaign=cnodejs&amp;utm_medium=display&amp;utm_content=yejiao&amp;ytag=cnodejs_logo" target="_blank" class="sponsor_outlink" data-label="ucloud_bottom">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/FuIpEaM9bvsZKnQ3QfPtBHWQmLM9" title="ucloud" alt="ucloud" width="92px">
    </a>
  ，存储赞助商为
    <a href="http://www.qiniu.com/?ref=cnode" target="_blank" class="sponsor_outlink" data-label="qiniu_bottom">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/Fg0jtDIcTqVC049oVu5-sn6Om4NX" title="七牛云存储" alt="七牛云存储" width="115px">
    </a>
  ，由<a href="https://alinode.aliyun.com/?ref=cnode" target="_blank" class="sponsor_outlink" data-label="alinode_bottom">
      <img src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/FpMZk31PDyxkC8yStmMQL4XroaGD" title="alinode" alt="alinode" height="54px" width="166px">
    </a>提供应用性能服务。
  </p>
  <p>新手搭建 Node.js 服务器，推荐使用无需备案的 <a href="https://www.digitalocean.com/?refcode=eba02656eeb3">DigitalOcean(https://www.digitalocean.com/)</a></p>
</div>


  </div>
</div>
<div id="sidebar-mask"></div>


<script>
  // google analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script', "https://www.google-analytics.com/analytics.js",'ga');

  ga('create', 'UA-41753901-5', 'auto');
  ga('send', 'pageview');
</script>



<div style="display:none;">
  <script src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/z_stat.php" language="JavaScript"></script><script src="./Mongoose学习参考文档——基础篇 - CNode技术社区_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1254020586" target="_blank" title="站长统计">站长统计</a>
</div>




</body></html>